#+TITLE: Why Clojure is Awesome
#+DESCRIPTION: Why we need to learn clojure and how it's different
#+KEYWORDS: clojure,tutorial,emacs,lisp,jvm
#+DATE: <2015-02-26 Thu>
#+BEGIN_SRC emacs-lisp
(require 'ob-clojure)** Number
Cojureæ”¯æŒå…¨é¢çš„æ•°å­—ç±»åž‹ï¼Œç”šè‡³åŒ…æ‹¬åˆ†æ•°ã€‚
#+BEGIN_SRC clojure :exports both
1/2
#+END_SRC

#+RESULTS:
: 1/2

** String

å­—ç¬¦ä¸²åªèƒ½ç”¨åŒå¼•å·å®šä¹‰å“¦ï¼Œå­—ç¬¦ä¸²çš„è¿žæŽ¥ä¸å†æ˜¯åŠ å·ï¼Œè€Œæ˜¯str

#+BEGIN_SRC clojure :exports both
(str "What's your name? " "I'm fine! " "thank you! " "and you?")
#+END_SRC

#+RESULTS:

å­—ç¬¦ä¸²éšä¾¿æ¢è¡Œ
#+BEGIN_SRC clojure
(def a "i am a
break")
#+END_SRC
** Vector

å‘é‡æ˜¯indexedçš„é›†åˆï¼Œç”¨æ–¹æ‹¬å·åˆå§‹åŒ–
#+BEGIN_SRC clojure :exports both
  [1 2 3 4]
  (vector 1 2 3 4)
#+END_SRC

#+RESULTS:
: => [1 2 3 4]

ç”±äºŽåŠ¨æ€ç±»åž‹ï¼Œè¿˜æ”¯æŒå‘é‡å†…çš„å…ƒç´ å¯ä»¥æ˜¯ä»»ä½•ç±»åž‹
#+BEGIN_SRC clojure :exports both
(get [1 "2" {3 "4"}] 2)
#+END_SRC

#+RESULTS:
: => {3 "4"}

** List

å’Œvectorç±»ä¼¼ï¼Œä½†æ˜¯å´ç¨å¾®ä¸åŒ
#+BEGIN_SRC clojure 
'(1 2 3 4)
(list 1 2 3 4)
#+END_SRC

#+RESULTS:
: => (1 2 3 4)

ä½†æ˜¯å–å…ƒç´ çš„æ—¶å€™å°±å’Œvectoræœ‰æ‰€ä¸åŒäº†
#+BEGIN_SRC clojure :exports both
  (nth '(1 2 3 4) 2)
#+END_SRC

#+RESULTS:
: => 3

** Set
é›†åˆä¹Ÿä¸€æ ·ï¼Œå…ƒç´ ç±»åž‹å¯ä»¥éšæ„
#+BEGIN_SRC clojure :exports both
#{"1" 2 :3}
(set ["1" 2 :3 :3])
#+END_SRC

#+RESULTS:
: => #{2 "1" :3}

** Keyword
æ…¢ç€ï¼Œåˆšåˆšçš„ =:3= æ˜¯ä¸ªä»€ä¹ˆçŽ©æ„

æ²¡é”™ï¼Œå¦‚æžœä½ ç”¨è¿‡rubyï¼ŒåŸºæœ¬ä¸Šæ—¶ä¸€ä¸ªä¸œè¥¿,ä½†æ˜¯å¯ä»¥æ˜¯ä»»ä½•å­—æ¯ï¼Œæ•°å­—ï¼Œç¬¦å·ï¼Œç”šè‡³åŒ…æ‹¬unicodeï¼Œæ¯”å¦‚emoji

æ²¡æœ‰é”™äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…¶å®žæ˜¯å¯ä»¥ç”¨ä¸­æ–‡å’Œå¯çˆ±çš„emojiç¼–ç¨‹çš„ï¼Œè™½ç„¶æœ‰ç‚¹æ€é©¬ç‰¹
#+BEGIN_SRC clojure
:abc
:34
:>_<b
:ä½ å¥½
:ðŸ˜±
#+END_SRC

** Map
map éžå¸¸ç®€å•ï¼Œå°±åƒå°†é”®å€¼å¯¹å†™åœ¨listé‡Œï¼Œä¸è¿‡éœ€è¦ç”¨èŠ±æ‹¬å·

è·Ÿå…¶ä»–è¯­è¨€ä¸ä¸€æ ·çš„æ˜¯keyå¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ï¼Œç”šè‡³æ˜¯listéƒ½å¯ä»¥ä½œä¸ºkey
#+BEGIN_SRC clojure :exports both
{:smile ðŸ˜€}
(get-in {:first-name "NiMa" :last-name "Wang" :å±žæ€§ {:é¢œå€¼ 0 :åæ§½èƒ½é‡ 100 }} [:å±žæ€§ :é¢œå€¼])

#+END_SRC

#+RESULTS:
: => 0

=get-in= é€šè¿‡ä¸€ä¸ªpathæ•°ç»„æ¥æ‰¾åˆ°æ·±åº¦çš„æŸä¸ªå€¼ã€‚
** lispä¸“ç”¨çš„ ' å¼•å·
å¦‚æžœä½ è§‰å¾—å‰é¢è¿™äº›å…¶å®žå…¶ä»–è¯­è¨€éƒ½æœ‰çš„è¯ï¼Œé‚£ä¹ˆä½ å¯èƒ½æ²¡æœ‰æ³¨æ„åˆ°åœ¨ä»‹ç»listæ—¶æœ‰è¿™æ ·ä¸€ä¸ªä¸èµ·çœ¼çš„çŽ©æ„ 'ã€‚

è¿™æ˜¯ä»€ä¹ˆå•Šï¼Ÿå…·ä½“æ˜¯ä»€ä¹ˆå¯èƒ½éœ€è¦ä¸“é—¨çš„ç¯‡å¹…æ¥ä»‹ç»ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘å¯ä»¥è§£é‡Šå®ƒå¤§æ¦‚æ˜¯ç¥žé©¬ã€‚

å¦‚æžœåœ¨lispé‡Œé¢è§åˆ°å•å¼•å·ï¼Œé‚£ä¹ˆä½ å®Œå…¨å¯ä»¥ç†è§£æˆliterallyåŽé¢é‚£ä¸ªä¸œè¥¿ï¼Œä»€ä¹ˆæ„æ€å‘¢ã€‚

#+BEGIN_SRC clojure
  (let [ç”·ç¥ž '(çŽ‹å°¼çŽ› çŽ‹å¤§é”¤ å¼ å…¨è›‹) å¥³ç¥ž '(å­”è¿žé¡º)]
    (first ç”·ç¥ž);=> çŽ‹å°¼çŽ›
    (first å¥³ç¥ž);=> å­”è¿žé¡º
    (first ['ç”·ç¥ž 'å¥³ç¥ž]);=>ç”·ç¥ž
    )
                                          
#+END_SRC
å¯ä»¥çœ‹åˆ° =ç”·ç¥ž= =å¥³ç¥ž= éƒ½æ˜¯listï¼Œä½†æ˜¯å¦‚æžœåœ¨ä»–ä»¬å‰é¢åŠ ä¸ªå•å¼•å·åŽï¼Œä»–ä»¬å°±å˜æˆäº†å­—é¢çš„å€¼ï¼Œä»–ä»¬ç¬¦å·æœ¬èº«ï¼Œè€Œä¸ä¼šè¢«evalæˆä¸€ä¸ªlistã€‚

æ‰€ä»¥ç”±äºŽlispé‡Œé¢æ‰€æœ‰çš„ =()= æ‹¬å·éƒ½æ˜¯listï¼Œä½†æ˜¯ä»–ä»¬æ˜¯ä¼šè¢«evalçš„listï¼Œä»–ä»¬çš„ä¼šè¿”å›ževalåŽçš„å€¼ï¼Œä½†æ˜¯å¦‚æžœåœ¨å‰é¢åŠ ä¸Šå•å¼•å·ï¼Œä»–ä»¬è¿”å›žä»–ä»¬æœ¬èº«ï¼Œlistï¼Œä¸ä¼šè¢«evalã€‚


** Let
ç­‰ç­‰ï¼Œåˆšåˆšé‚£ä¸ª =let= æ˜¯ä»€ä¹ˆçŽ©æ„ï¼Ÿletå…³é”®å­—éžå¸¸æœ‰æ„æ€ï¼Œåœ¨å…¶ä»–è¯­è¨€å¦‚jsé‡Œè™½ç„¶æ²¡æœ‰è¿™ä¸ªå…³é”®å­—ï¼Œä½†æ˜¯åŠŸèƒ½å¤§è‡´å¯ä»¥ç¿»è¯‘æˆ
#+BEGIN_SRC javascript
  (function(ç”·ç¥ž,å¥³ç¥ž){
    ç”·ç¥ž[0]
    å¥³ç¥ž[0]
  }).call(this, ['çŽ‹å°¼çŽ›','çŽ‹å¤§é”¤','å¼ å…¨è›‹'],['å­”è¿žé¡º'])
#+END_SRC
ä½†æ˜¯jsé‡Œé¢å¾ˆå°‘è¿™ä¹ˆå¹²ï¼Œä¸æ˜¯ä¹ˆã€‚æˆ‘ä»¬é€šå¸¸ä¼šç›´æŽ¥ã€‚
#+BEGIN_SRC javascript
var ç”·ç¥ž=['çŽ‹å°¼çŽ›','çŽ‹å¤§é”¤','å¼ å…¨è›‹'],å¥³ç¥ž=['å­”è¿žé¡º'];
ç”·ç¥ž[0];
å¥³ç¥ž[0];
#+END_SRC
ç”¨ =var= æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚å½“ç„¶å°±æ˜¯scopeä¸ä¸€æ ·ï¼Œå‰ä¾‹ä¸­å‡½æ•°å†…éƒ¨çš„ =ç”·ç¥ž= =å¥³ç¥ž= ä¸¤ä¸ªå€¼çš„ç»‘å®šä¸ä¼šå—åˆ°å‡½æ•°å¤–çš„å½±å“ï¼ŒåŒæ ·ä¹Ÿä¸ä¼šå¯¹å¤–ç•Œé€ æˆä»»ä½•å½±å“ã€‚

æ¯”å¦‚
#+BEGIN_SRC javascript
  var ç”·ç¥ž='è‘«èŠ¦å¨ƒ';
    (function(ç”·ç¥ž,å¥³ç¥ž){
      ç”·ç¥ž[0]; //=> çŽ‹å°¼çŽ›
    }).call(this, ['çŽ‹å°¼çŽ›','çŽ‹å¤§é”¤','å¼ å…¨è›‹'],['å­”è¿žé¡º'])
  ç”·ç¥ž; //=> è‘«èŠ¦å¨ƒ
#+END_SRC

** TODO loop recur
clojureçš„æ•°æ®ç»“æž„éƒ½æ˜¯immutableçš„ï¼Œæ„å‘³ç€ä½ ï¼ˆå¦‚æžœä¸ç”¨macroçš„è¯ï¼‰ä¸èƒ½åƒå…¶ä»–è¯­è¨€ä¸€æ ·å†™forå¾ªçŽ¯ï¼Œä¹Ÿä¸èƒ½æƒ³å…¶ä»–è¯­è¨€è¿™æ ·è¿™æ ·çš„...
#+BEGIN_SRC javascript
  var ç”·ç¥ž=['çŽ‹å°¼çŽ›','çŽ‹å¤§é”¤','å¼ å…¨è›‹'];
  ç”·ç¥ž[0]='è‘«èŠ¦å¨ƒ';
  ç”·ç¥ž // => ['è‘«èŠ¦å¨ƒ','çŽ‹å¤§é”¤','å¼ å…¨è›‹']
#+END_SRC
åŽä¸€ç§å¥½è§£å†³ï¼Œå¤§ä¸äº†åˆ›å»ºä¸€ä¸ªæ–°çš„ =ç”·ç¥ž= ä½†æ˜¯forå¾ªçŽ¯æ€Žä¹ˆæžï¼Ÿåœ¨å‡½æ•°å¼è¯­è¨€ä¸­ï¼Œå¾ªçŽ¯å’ŒéåŽ†éƒ½å¿…é¡»è¦é€šè¿‡é€’å½’æ¥å®žçŽ°å‘¢ã€‚è€Œåœ¨clojureä¸­ï¼Œå†™ä¸€ä¸ªé€’å½’æ˜¯å¦‚æ­¤çš„ç®€å•ã€‚
#+BEGIN_SRC clojure

#+END_SRC
** å‡½æ•°!å‡½æ•°!
æ¯ä¸ªä¸å¸¦'çš„listéƒ½æ˜¯å‡½æ•°è¡¨è¾¾å¼, å•Šå“ˆå“ˆå“ˆ, ç”šè‡³æ˜¯åŠ å‡ä¹˜é™¤. æ¯”å¦‚ =(+ 1 2)=,  ä½ å¯èƒ½è§‰å¾—è¯»ç€åˆ«æ‰­. ä½†æ˜¯å¦‚æžœ
#+BEGIN_SRC clojure
(+ 1 2 3 4 5)
#+END_SRC

æ˜¯ä¸æ˜¯çž¬é—´æ„Ÿè§‰åˆ°åŠ å·ä¸å†æ˜¯æ“ä½œç¬¦, è€Œæ˜¯å‡½æ•°å‘¢. å¦‚æžœrubyä¹Ÿå¯ä»¥å®šä¹‰å‡½æ•°å« =+= çš„è¯,é‚£å°±æ˜¯
#+BEGIN_SRC ruby
+ 1, 2, 3, 4, 5
#+END_SRC
æ˜¯ä¸æ˜¯è§‰å¾—ä¸€ç‚¹ä¹Ÿä¸æ€ªäº†.

è¯´åˆ°è¡¨è¾¾å¼, rubyæˆ–è€…jsç¨‹åºå‘˜ç»å¸¸è¿™æ ·å¹²
#+BEGIN_SRC ruby
c = a || b
#+END_SRC
æ„æ€æ˜¯å¦‚æžœ =a= ä¸ç©º =c= å°±ç­‰äºŽ =a=, ä¸ç„¶å°±ç­‰äºŽ =b=

è€Œåœ¨clojureä¸­, å¯ä»¥ç”¨è¡¨è¾¾å¼æ¥å¹²æ›´å±Œçš„äº‹æƒ…
#+BEGIN_SRC clojure
(or 1 0) ;=> 1
((or - +) 1 2 3) ;=> 6
#+END_SRC
çœ‹ç€æ€ªæ€ªçš„,åŠ å·æ€Žä¹ˆè·Ÿå€¼ä¸€æ ·è¢«è¡¨è¾¾å¼è¿”å›ž,è€Œä¸”è¿˜åœ¨å¤–é¢çš„è¡¨è¾¾å¼ä¸­å˜æˆäº†å‡½æ•°.

å¦‚æžœè¦ç”¨jsæ¥å®žçŽ°ä¸€éå¯èƒ½æ˜¯æ¯”è¾ƒå›°éš¾çš„äº‹æƒ….orå‡½æ•°è¿”å›žä¸€ä¸ªå‡½æ•°,å†æŠŠå‚æ•°applyåˆ°è¿™ä¸ªå‡½æ•°ä¸Š.
clojureæ˜¯æ€Žä¹ˆåšåˆ°çš„å‘¢. äº‹å®žä¸Šlispæ˜¯éžå¸¸ç®€å•çš„è¯­è¨€.
å®ƒåªæ˜¯æŠŠè¡¨è¾¾å¼å±‚å±‚å±•å¼€ç„¶åŽå†ä¾æ¬¡evalè€Œå·².ä¸å•å•æ˜¯å‚æ•°å¯ä»¥å±•, å‡½æ•°ä¸ºä»€ä¹ˆä¹Ÿèƒ½å±•å‡ºæ¥?

é¦–å…ˆä¸è¦æƒ³è±¡ä»–æ˜¯ä¸€ä¸ªå‡½æ•°, æ¯”å¦‚ =\'(or - +)= å…¶å®žæ˜¯ä¸€ä¸ªlist, å½“ä¸åŠ ç‚¹çš„æ—¶å€™, ç›¸å½“äºŽ
=(eval '(or - +))= , è¿™æ ·ä¸€æ¥, æ—¢ç„¶æ˜¯list, listé‡Œé¢çš„æ¯ä¸ªå…ƒç´ å½“ç„¶éƒ½å¯ä»¥ä¹Ÿæ˜¯list, =((or - +) 1 2 3)= å°±æ˜¯ä¸€ä¸ªç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºlistçš„listè€Œå·², å½“lisp eval
è¿™ä¸ªlistæ¥å–å€¼çš„æ—¶å€™æ˜¯ä»Žé‡Œåˆ°å¤–è¿›è¡Œeval, ç„¶åŽæŠŠevalå‡ºæ¥å¾—åˆ°çš„å¤§listå†evalä¸€ä¸‹, ä¹Ÿå°±æ˜¯

#+BEGIN_SRC clojure
((or - +) 1 2 3) ; (or - +) => +
(+ 1 2 3)
6
#+END_SRC

