<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2020-04-11 Sat 15:14 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Functional JavaScript Mini Book</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Jichao Ouyang">
<link rel="icon" href="/favicon.ico">
<meta name="theme-color" content="#ffffff">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="/style/toc.css"/>
<link rel="stylesheet" href="/style/tufte.css"/>
<link rel="alternate" type="application/rss+xml" title="Jichao Ouyang" href="https://feeds.oyanglul.us/JichaoOuyangsBlog"/>

<script type="text/javascript" src="https://orgmode.org/org-info.js">
/**
 *
 * @source: https://orgmode.org/org-info.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in https://orgmode.org/org-info.js.
 *
 * Copyright (C) 2012-2020 Free Software Foundation, Inc.
 *
 *
 * The JavaScript code in this tag is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in https://orgmode.org/org-info.js.
 *
 */
</script>

<script type="text/javascript">

/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/

<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "4");
org_html_manager.set("LINK_HOME", "");
org_html_manager.set("LINK_UP", "");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "0");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJRFJGX"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<header>
    <a accesskey="h" href="/index.html"> HOME </a> |
    <a href="#" id="edit-in-github">EDIT</a> |
    <a href="https://feeds.oyanglul.us/JichaoOuyangsBlog">RSS</a> |
    <a href="https://blog.oyanglul.us/theindex">INDEX</a> |
    <a accesskey="H" href="/jichao.ouyang.html">ABOUT</a> |
    <a href="https://github.com/jcouyang/blog">GITHUB</a>
</header>
</div>
<div id="content">
<header>
<h1 class="title">Functional JavaScript Mini Book</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org675b31d">1. Preface</a></li>
<li><a href="#orga72630f">2. Lambda</a>
<ul>
<li><a href="#org289775f">2.1. ç®­å¤´å‡½æ•°(arrow function)</a>
<ul>
<li><a href="#org0cc26af">2.1.1. å£°æ˜ä¸€ä¸ªç®­å¤´å‡½æ•°</a></li>
<li><a href="#orgfeb529a">2.1.2. ä¸ºä»€ä¹ˆè¦ç”¨ç®­å¤´å‡½æ•°</a></li>
<li><a href="#org0301e6e">2.1.3. Lexical <code>this</code></a></li>
</ul>
</li>
<li><a href="#org961f9c8">2.2. JavaScriptçš„åŒ¿åå‡½æ•°(anonymous function)</a>
<ul>
<li><a href="#org1733ae0">2.2.1. åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°</a></li>
<li><a href="#org3c72302">2.2.2. ä½¿ç”¨åŒ¿åå‡½æ•°</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org589ddad">3. é«˜é˜¶å‡½æ•°(Higher-order function)</a>
<ul>
<li><a href="#orgfb8a189">3.1. Higher-order function</a>
<ul>
<li><a href="#orgc36b72f">3.1.1. å‡½æ•°ä½œä¸ºå‚æ•°</a></li>
<li><a href="#org9dcfa62">3.1.2. å‡½æ•°ä½œä¸ºè¿”å›å€¼</a></li>
</ul>
</li>
<li><a href="#orgc6fa5cf">3.2. æŸ¯é‡ŒåŒ– currying</a>
<ul>
<li><a href="#org9d68875">3.2.1. æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªé—®é¢˜</a>
<ul>
<li><a href="#org4ef6c2b">å†™ä¸€ä¸ªå‡½æ•°, å¯ä»¥è¿æ¥å­—ç¬¦æ•°ç»„, å¦‚ f(['1','2']) =&gt; '12'</a></li>
<li><a href="#orgaae5a9c">ç°åœ¨æˆ‘è¦å…¶ä¸­æ‰€æœ‰æ•°å­—åŠ 1, ç„¶ååœ¨è¿æ¥</a></li>
<li><a href="#orgfa21a85">æ‰€æœ‰æ•°å­—ä¹˜ä»¥2, å†é‡æ„è¯•è¯•çœ‹</a></li>
</ul>
</li>
<li><a href="#orgb2b4305">3.2.2. æŸ¯é‡ŒåŒ–å‡½æ•°æ¥å£</a></li>
<li><a href="#org5118c19">3.2.3. è‡ªåŠ¨æŸ¯é‡ŒåŒ–</a></li>
</ul>
</li>
<li><a href="#org5a78310">3.3. å‡½æ•°ç»„åˆ function composition</a>
<ul>
<li><a href="#org60201ca">3.3.1. Compose</a></li>
<li><a href="#org1eed985">3.3.2. pipe</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgd96bfe5">4. Transducers</a>
<ul>
<li><a href="#orgbfe0537">4.1. Reducer</a>
<ul>
<li><a href="#org71dbcb7">4.1.1. transform</a></li>
<li><a href="#org5444796">4.1.2. Reducer</a>
<ul>
<li><a href="#org18e2277">Reducible</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org362ac0c">4.2. Transducer</a></li>
<li><a href="#org9b5d2eb">4.3. Is it Curry?</a></li>
<li><a href="#org1fb9d37">4.4. å®Œæ•´ä¾‹å­</a></li>
</ul>
</li>
<li><a href="#orgf3599f7">5. Functor</a>
<ul>
<li><a href="#org9041e26">5.1. Functor</a></li>
<li><a href="#org275921a">5.2. ä¸¾ä¸ªæ —å­ğŸŒ°</a></li>
<li><a href="#org6ab7600">5.3. Functor in JavaScript</a></li>
</ul>
</li>
<li><a href="#org4f73a27">6. Monad</a>
<ul>
<li><a href="#org8dec7d7">6.1. Either</a></li>
<li><a href="#orgffb6c2b">6.2. èµ°é’¢ç´¢</a>
<ul>
<li><a href="#org1728e35">6.2.1. ä¸€èˆ¬è§£æ³•</a></li>
<li><a href="#org074fc4b">6.2.2. ç°åœ¨æ¥è¯•è¯•ç”¨ Either</a></li>
</ul>
</li>
<li><a href="#org27af63c">6.3. åˆ°åº•æœ‰ä»€ä¹ˆç”¨å‘¢, Monad</a></li>
<li><a href="#org276320c">6.4. Monad åœ¨ JavaScript ä¸­çš„åº”ç”¨</a></li>
</ul>
</li>
</ul>
</div>
</nav>
<p>
<a href="https://blog.oyanglul.us/shutting-down-gulugulu">ğŸ“£ ä¸è¦å†æ‰¾äº†, å¼¹å¹•åŠŸèƒ½å·²å…³é—­</a>
</p>
<div class="org-center">
<p>
âš  DEPRETICATED âš 
</p>

<p>
æœ¬ä¹¦å·² <del>è¿‡æ—¶</del> åœæ›´ï¼Œè¯·è½¬åˆ°æ–°ä¹¦ 
</p>

<p>
ğŸ‘‰ <a href="https://oyanglul.us/clojure-flavored-javascript/">ã€ŠClojure Flavored JavaScriptã€‹</a> ğŸ‘ˆ
</p>

<p>
å½“ç„¶ï¼Œä½ ä¾ç„¶å¯ä»¥è¯·<a href="https://gum.co/fpjs">æˆ‘å–ä¸€æ¯å’–å•¡</a> â˜•
</p>


<figure>
<img src="./images/shut-up-and-take-my-money.gif" alt="shut-up-and-take-my-money.gif">

</figure>
</div>

<div id="outline-container-org675b31d" class="outline-2">
<h2 id="org675b31d"><span class="section-number-2">1</span> Preface</h2>
<div class="outline-text-2" id="text-1">
<p>
è¿™æ˜¯æœ¬å¯èƒ½2å°æ—¶å°±èƒ½çœ‹å®Œçš„å°ä¹¦ï¼Œä½†æ˜¯æ¶µç›–äº†åŸºæœ¬æ‰€æœ‰å‡½æ•°å¼ç¼–ç¨‹çš„å†…å®¹ï¼Œè¿˜åŒ…å«äº†ä¸€äº›
ECMAScript 6 å®šä¹‰çš„å‡½æ•°å¼æ–°ç‰¹æ€§, å¦‚ç®­å¤´å‡½æ•°, æ¨¡å¼åŒ¹é…ç­‰ç­‰.
è¿˜ä¼šä»‹ç»å‡½æ•°å¼ä¸€äº›é‡è¦æ¦‚å¿µåœ¨ JavaScriptæ˜¯å¦‚ä½•å®ç°å³åº”ç”¨,
ä»¥åŠå¦‚ä½•ä»¥å‡½æ•°å¼çš„æ€æƒ³ç¼–å†™ JavaScript ä»£ç .
</p>

<div class="epigraph"><blockquote>
<p>
æœ¬ä¹¦è™½ç„¶ä¸æˆ‘ç¿»è¯‘çš„Michael Fogusçš„<a href="http://book.douban.com/subject/22733640/">Functional JavaScript</a>åŒå, ä½†æ˜¯è¯·ä¸è¦å½“æˆæ˜¯Foguså¤§å¸ˆçš„miniç‰ˆæœ¬, 
è¿™é‡Œçš„å†…å®¹å®Œå…¨è·ŸFoguså¤§å¸ˆçš„ä¸ä¸€æ ·, å¯èƒ½æ¯”å¤§å¸ˆçš„è¦å†"å‡½æ•°å¼"ä¸€äº›<label for="1" class="margin-toggle sidenote-number"></label><input type="checkbox" id="1" class="margin-toggle"/><span class="sidenote">
FogusåŒæ—¶æ˜¯The Joy of Clojureçš„ä½œè€…,æˆ‘
ç‰¹åˆ«å¥‡æ€ªä¸ºä»€ä¹ˆä¸æŠŠClojureçœŸæ­£Good partå†™è¿›Functional JavaScripté‡Œ
</span>, ç”¨jså®ç°äº†ä¸€äº›å…¶ä»–å‡½æ•°å¼è¯­è¨€(Clojure, Haskell)ç‰¹æœ‰çš„å‡½æ•°å¼features.
</p>

</blockquote></div>

<p>
å¯¹æœJavaScriptçš„åŸºæœ¬æ¦‚å¿µå¯¹ä½ æ¥è¯´:
</p>


<figure>
<img src="./images/preface/what_you_talking.gif" alt="what_you_talking.gif">

</figure>

<p>
å¯èƒ½æœ¬ä¹¦å¹¶ä¸é€‚åˆä½ , è¯·å…ˆç§»æ­¥ <a href="https://leanpub.com/javascript-allonge">JavaScript Allonge</a>,
ä½†æ˜¯å¦‚æœä½ å­¦ä¹ å‡½æ•°å¼ç¼–ç¨‹æ—¶æ„Ÿåˆ°è´¹è§£:
</p>


<figure>
<img src="./images/preface/summarize_in_one_word.gif" alt="summarize_in_one_word.gif">

<figcaption><span class="figure-number">Figure 3: </span>I'm not reading the crap, summarize in one word</figcaption>
</figure>

<p>
é‚£ä¹ˆè¿™æœ¬ä¹¦å°†ä¼šå¯¹ä½ ä¼šæœ‰æ‰€å¸®åŠ©.
</p>

<p>
æˆ‘é€‰ç”¨çš„ JavaScript å‡½æ•°å¼åº“æ˜¯
<a href="https://rawgit.com/CrossEye/eweda/master/docs/eweda.html">Eweda</a>(<a href="https://ramdajs.com">Ramda</a> çš„æœ€åˆå®ç°ï¼Œæ›´éµå®ˆå‡½æ•°å¼æ•™æ¡ï¼Œä½†ç”±äº
javascript çš„æ ˆå¾ˆå®¹æ˜“çˆ†ï¼ŒRamdaçš„å®ç°è¦æ›´ pratical
ä¸€äº›è€Œä¸”å¯ä»¥ç”¨çš„äº§å“ä»£ç ä¸­ï¼Œ åƒä¸‡ä¸è¦åœ¨äº§å“ä¸­ç”¨
eweda,è¿™é‡Œåªç”¨ewedaåšä»‹ç»ç›®çš„)
</p>

<div class="epigraph"><blockquote>
<p>
<a href="https://fr.umio.us/why-ramda/">ä¸ºä»€ä¹ˆä¸ç”¨ Underscore/Lodash</a> è¯·ç§»æ­¥ç¬¬äºŒç« 
</p>

</blockquote></div>

<div class="epigraph"><blockquote>
<p>
ç”±äºä¼šä»‹ç» ECMAScript 6 çš„æ–°ç‰¹æ€§, ä¹¦ä¸­å¾ˆå¤šå†™æ³•éƒ½æ˜¯ ECMAScript
6 æ ‡å‡†, åªèƒ½åœ¨å®ç°è¿™äº› feature çš„æµè§ˆå™¨(å¦‚ Firefox,
è¯·ç›®å‰å‚ç…§å„æµè§ˆå™¨çš„<a href="https://kangax.github.io/compat-table/es6/">å®ç°æƒ…å†µ</a>) é‡Œè¿è¡Œ.
å¦å¤–, å¤§å¤šæ•°çš„ä¾‹å­æºç éƒ½ä¼šåœ¨æ–‡ç« é‡Œçš„ jsbin é“¾æ¥é‡Œ.
</p>

</blockquote></div>
</div>
</div>

<div id="outline-container-orga72630f" class="outline-2">
<h2 id="orga72630f"><span class="section-number-2">2</span> Lambda</h2>
<div class="outline-text-2" id="text-2">
<p>
ä¸ºä»€ä¹ˆè®² lambda, å¦‚æœå°æ—¶å€™ç©è¿‡æ¸¸æˆ"åŠæ¡å‘½",é‚£ä¹ˆä½ æ—©éƒ½è§è¿‡ lambda äº†.
</p>


<figure>
<img src="./images/lambda/Lambda_reactor_complex_logo.png" alt="Lambda_reactor_complex_logo.png">

</figure>

<p>
æˆ‘ä»wikipediaé‡Œé¢ç²˜å‡ºæ¥äº†è¿™ä¹ˆä¸€æ®µå®šä¹‰:
</p>
<div class="epigraph"><blockquote>
<p>
lambdaåŒ…æ‹¬ä¸€æ¡å˜æ¢è§„åˆ™ï¼ˆå˜é‡æ›¿æ¢ï¼‰å’Œä¸€æ¡å‡½æ•°å®šä¹‰æ–¹å¼ï¼ŒLambdaæ¼”ç®—ä¹‹é€šç”¨åœ¨äºï¼Œä»»ä½•ä¸€ä¸ªå¯è®¡ç®—å‡½æ•°éƒ½èƒ½ç”¨è¿™ç§å½¢å¼æ¥è¡¨è¾¾å’Œæ±‚å€¼ã€‚å› è€Œï¼Œå®ƒæ˜¯ç­‰ä»·äºå›¾çµæœºçš„.
</p>

</blockquote></div>

<p>
å¥½å§, è·Ÿæ²¡è§£é‡Šä¸€æ ·. ç®€å•æ¥è¯´lambdaå…¶å®å°±æ˜¯ <code>x</code> åˆ° <code>y</code> çš„æ˜ å°„å…³ç³», ä½†åœ¨å¤§éƒ¨åˆ†æ”¯æŒå‡½æ•°å¼çš„ç¼–ç¨‹è¯­è¨€ä¸­,
å®ƒç­‰ä»·äºåŒ¿åå‡½æ•°. è¢«ç§°ä¸º lambda è¡¨è¾¾å¼.
å› ä¸ºè¿™äº›å‡½æ•°åªéœ€è¦ç”¨ä¸€æ¬¡, è€Œä¸”å˜æ¢ä¸å¤æ‚, å®Œå…¨ä¸éœ€è¦å‘½å.
</p>


<figure>
<img src="./images/lambda/parallel-universe.gif" alt="parallel-universe.gif">

</figure>

<p>
åŒ¿åå‡½æ•°åœ¨ç¨‹åºä¸­çš„ä½œç”¨æ˜¯å¯ä»¥ä½œä¸ºå‚æ•°ä¼ ç»™é«˜é˜¶å‡½æ•°<label for="2" class="margin-toggle sidenote-number"></label><input type="checkbox" id="2" class="margin-toggle"/><span class="sidenote">
ç¬¬äºŒç« ä¼šè¯¦ç»†è§£é‡Šé«˜é˜¶å‡½æ•°å’Œé—­åŒ….
</span>, æˆ–è€…ä½œä¸ºé—­åŒ…è¢«è¿”å›.
</p>

<p>
ä½†æ˜¯åŒ¿åå‡½æ•°å¹¶ä¸æ˜¯åŸæœ¬çš„ lambda ç®—å­, å› ä¸ºåŒ¿åå‡½æ•°ä¹Ÿå¯ä»¥æ¥å—å¤šä¸ªå‚æ•°, å¦‚
</p>

<pre class="example">
multiple(x, y) = x*y
</pre>

<p>
å†™æˆç®€å•æ˜ å°„çš„å½¢å¼, æŠŠåå­—å»æ‰
</p>

<pre class="example">
(x,y) -&gt; x*y
</pre>

<p>
è¿™å°±æ˜¯ lambda äº†å—, ä¸æ˜¯, lambdaçš„ç”¨æ„æ˜¯ç®€åŒ–è¿™ä¸ªæ˜ å°„å…³ç³»ä»¥è‡³ä¸éœ€è¦åå­—,
æ›´é‡è¦çš„æ˜¯åªæ˜ å°„ä¸€ä¸ª x.
</p>

<p>
ä»€ä¹ˆæ„æ€å‘¢? è®©æˆ‘ä»¬æ¥åˆ†è§£ä¸€ä¸‹ä¸Šé¢çš„è¿™ä¸ªæ˜ å°„çš„è¿‡ç¨‹.
</p>

<ol class="org-ol">
<li><p>
lambda æ¥å—ç¬¬ä¸€ä¸ªå‚æ•° <code>5</code>, è¿”å›å¦ä¸€ä¸ª lambda
</p>

<pre class="example">
(5) -&gt; (y -&gt; 5*y) 
</pre></li>

<li>è¯¥è¿”å›çš„ lambda <code>y -&gt; 5*y</code> æ¥æ”¶ <code>y</code> å¹¶ä¸”è¿”å› <code>5*y</code>, è‹¥åœ¨ç”¨ <code>4</code> è°ƒç”¨è¯¥ lambda</li>
</ol>

<pre class="example">
es6 -&gt; 5*4
</pre>

<p>
å› æ­¤è¿™é‡Œçš„åŒ¿åå‡½æ•° <code>(x,y)-&gt;x*y</code> çœ‹ä¼¼ä¸€ä¸ª lambda, å…¶å®æ˜¯ä¸¤ä¸ª lambda
çš„ç»“åˆ.
</p>

<p>
è€Œè¿™ç§æ¥å—ä¸€ä¸ªå‚æ•°è¿”å›å¦ä¸€ä¸ªæ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°çš„å‡½æ•°å«æŸ¯é‡ŒåŒ–<label for="3" class="margin-toggle sidenote-number"></label><input type="checkbox" id="3" class="margin-toggle"/><span class="sidenote">
æŸ¯é‡ŒåŒ–ä¼šåœ¨ç¬¬äºŒç« è¯¦ç»†è®¨è®º.
</span>.
</p>

<p>
è¿™é‡Œæˆ‘ä»¬å…ˆå¿ä¸€å¿, æ¥çœ‹ä¸‹ JavaScript ä¸­çš„ lambda è¡¨è¾¾å¼.
</p>
</div>
<div id="outline-container-org289775f" class="outline-3">
<h3 id="org289775f"><span class="section-number-3">2.1</span> ç®­å¤´å‡½æ•°(arrow function)</h3>
<div class="outline-text-3" id="text-2-1">
<p>
æ¥çœ‹çœ‹è¶Šæ¥è¶Šå‡½æ•°å¼ã® JavaScript
</p>

<p>
æ–°çš„è‰æ¡ˆ<a href="https://kangax.github.io/compat-table/es6/">ECMAScript 6</a>
(è™½ç„¶è¯´æ˜¯è‰æ¡ˆ,ä½†ä½ å¯ä»¥çœ‹åˆ° Firefox å…¶å®å·²ç»å®ç°å¤§éƒ¨åˆ†çš„
feature)é‡Œæˆ‘ä»¬è¶Šæ¥è¶Šè¿‘äº†, å€ŸåŠ©ä¸€ä¸‹transcompilerä¾‹å¦‚<a href="https://babeljs.io">Babel</a> æˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨é¡¹ç›®ä¸­å¼€å§‹ä½¿ç”¨es6äº†<label for="4" class="margin-toggle sidenote-number"></label><input type="checkbox" id="4" class="margin-toggle"/><span class="sidenote">
å¯ä»¥çœ‹çœ‹es6æ¯”è¾ƒæœ‰æ„æ€çš„æ–°ç‰¹æ€§ <a href="https://blog.oyanglul.us/javascript/essential-ecmascript6.html">https://blog.oyanglul.us/javascript/essential-ecmascript6.html</a>
</span>ã€‚
</p>

<p>
çœ‹çœ‹é‡Œé¢æœ‰ä¸€è¡Œ arrow
functionï¼Œä¸ºä»€ä¹ˆå«ç®­å¤´å‡½æ•°ï¼Œè¿˜è®°å¾—å‰é¢è¯´lambdaæ˜¯æåˆ°çš„ç®­å¤´å—ã€‚è€Œä¸”å¦‚æœä½ ä¹‹å‰ç”¨è¿‡
Haskell(å•ç®­å¤´) æˆ–è€…Scala(åŒç®­å¤´), ä¼šå‘ç°éƒ½ç”¨çš„æ˜¯ç®­å¤´æ¥è¡¨ç¤ºç®€å•æ˜ å°„å…³ç³».
</p>

<div class="epigraph"><blockquote>
<p>
ç”±äº arrow function åªåœ¨Firefox 22ä»¥ä¸Šç‰ˆæœ¬å®ç°,
æœ¬èŠ‚çš„æ‰€æœ‰ä»£ç éƒ½å¯ä»¥åœ¨Firefoxçš„Consoleä¸­è°ƒè¯•, å…¶ä»–chrome ä»€ä¹ˆçš„éƒ½æ²¡æœ‰å®ç°(å®Œå…¨)<label for="5" class="margin-toggle sidenote-number"></label><input type="checkbox" id="5" class="margin-toggle"/><span class="sidenote">
Chromeæœ‰ä¸€ä¸ª feature toggle å¯ä»¥æ‰“å¼€éƒ¨åˆ† es6 åŠŸèƒ½ <code>chrome://flags/#enable-javascript-harmony</code>
</span>.
å¦å¤–æ¯èŠ‚çš„æœ€åæˆ‘éƒ½ä¼šç»™å‡ºå®Œæ•´ä»£ç çš„å¯æ‰§è¡Œçš„ jsbin é“¾æ¥.
</p>

</blockquote></div>
</div>

<div id="outline-container-org0cc26af" class="outline-4">
<h4 id="org0cc26af"><span class="section-number-4">2.1.1</span> å£°æ˜ä¸€ä¸ªç®­å¤´å‡½æ•°</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
ä½ å¯ä»¥ç”¨ä¸¤ç§æ–¹å¼å®šä¹‰ä¸€ä¸ªç®­å¤´å‡½æ•°
</p>

<pre class="example">
([param] [, param]) =&gt; {
   statements
}
// or
param =&gt; expression
</pre>

<p>
å•ä¸ªè¡¨è¾¾å¼å¯ä»¥å†™æˆä¸€è¡Œ, è€Œå¤šè¡Œè¯­å¥åˆ™éœ€è¦ block <code>{}</code> æ‹¬èµ·æ¥.
</p>
</div>
</div>

<div id="outline-container-orgfeb529a" class="outline-4">
<h4 id="orgfeb529a"><span class="section-number-4">2.1.2</span> ä¸ºä»€ä¹ˆè¦ç”¨ç®­å¤´å‡½æ•°</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
çœ‹çœ‹æ—§çš„åŒ¿åå‡½æ•°æ€ä¹ˆå†™ä¸€ä¸ªä½¿æ•°ç»„ä¸­æ•°å­—éƒ½ä¹˜2çš„å‡½æ•°.
</p>

<pre class="example">
var a = [1,2,curry,es6,5];
a.map(function(x){ return x*2 });
</pre>

<p>
ç”¨ç®­å¤´å‡½æ•°ä¼šå˜æˆ
</p>

<pre class="example">
a.map(x =&gt; x*2);
</pre>

<p>
åªæ˜¯å°‘äº† <code>function</code> å’Œ <code>return</code> ä»¥åŠ block, ä¸æ˜¯å—? å¦‚æœè§‰å¾—å·®ä¸å¤š,
å› ä¸ºä½ çœ‹æƒ¯äº† JavaScript çš„åŒ¿åå‡½æ•°,
ä½ çš„å¤§è„‘ç¼–è¯‘å™¨è‡ªåŠ¨çš„å¿½ç•¥äº†,å› ä¸ºä»–ä»¬ä¸éœ€è¦æ˜¾ç¤ºçš„å­˜åœ¨.
</p>

<p>
è€Œ <code>map(x =&gt; x*2)</code> è¦æ›´ make sense,
å› ä¸ºæˆ‘ä»¬éœ€è¦çš„åŒ¿åå‡½æ•°åªéœ€è¦åšä¸€ä»¶äº‹æƒ…, æˆ‘ä»¬éœ€è¦çš„æ˜¯ ä¸€ä¸ªå‡½æ•° <code>f</code>,
å¯ä»¥å°†ç»™å®š <code>x</code>, æ˜ å°„åˆ° <code>y</code>.
ç¿»è¯‘è¿™å¥è¯çš„æœ€ç®€å•çš„æ–¹å¼ä¸å°±æ˜¯ <code>f = (x =&gt; x*2)</code>
</p>
</div>
</div>

<div id="outline-container-org0301e6e" class="outline-4">
<h4 id="org0301e6e"><span class="section-number-4">2.1.3</span> Lexical <code>this</code></h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
å¦‚æœä½ è§‰å¾—è¿™è¿˜ä¸è¶³ä»¥è¯´æœæ”¹å˜åŒ¿åå‡½æ•°çš„å†™æ³•,
é‚£ä¹ˆæƒ³æƒ³ä»¥å‰å†™åŒ¿åå‡½æ•°ä¸­çš„ç»å¸¸éœ€è¦ <code>var self=this</code> çš„è‹¦æ¼.
</p>

<div class="org-src-container">
<pre class="src src-js">    <span style="color: #00008b;">var</span> <span style="color: #b8860b;">Multipler</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">inc</span>){
      <span style="color: #6b8e23;">this</span>.inc = inc;
    }
    Multipler.<span style="color: #6b8e23;">prototype</span>.multiple = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">numbers</span>){
      <span style="color: #00008b;">return</span> numbers.map(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">number</span>){
        <span style="color: #00008b;">return</span> <span style="color: #6b8e23;">this</span>.inc * number;
      })
    }
    <span style="color: #00008b;">new</span> <span style="color: #36648b;">Multipler</span>(2).multiple([1,2,curry,es6]) 
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; [NaN, NaN, NaN, NaN]  &#19981; work, &#22240;&#20026; map &#37324;&#38754;&#30340; this &#25351;&#21521;&#30340;&#26159;&#20840;&#23616;&#21464;&#37327;( window)</span>

    Multipler.<span style="color: #6b8e23;">prototype</span>.multiple = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">numbers</span>){
      <span style="color: #00008b;">var</span> <span style="color: #b8860b;">self</span> = <span style="color: #6b8e23;">this</span>; <span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">&#20445;&#25345; Multipler &#30340; this &#30340;&#32531;&#23384;</span>
      <span style="color: #00008b;">return</span> numbers.map(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">number</span>){
        <span style="color: #00008b;">return</span> self.inc * number;
      })
    }
    <span style="color: #00008b;">new</span> <span style="color: #36648b;">Multipler</span>(2).multiple([1,2,curry,es6]) <span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; [ 2, es6, 6, 8 ]</span>
</pre>
</div>

<p>
å¾ˆæ€ªä¸æ˜¯å—, ç¡®å®æ˜¯ Javascript çš„ä¸€ä¸ª bug, å› æ­¤ç»å¸¸å‡ºç°åœ¨å„ç§é¢è¯•é¢˜ä¸­, é—® <code>this</code> åˆ°åº•æ˜¯è°.
</p>


<figure>
<img src="./images/lambda/which-leela.gif" alt="which-leela.gif">

</figure>

<p>
è¯•è¯•æ›¿æ¢æˆ arrow function
</p>

<div class="org-src-container">
<pre class="src src-js">Multipler.<span style="color: #6b8e23;">prototype</span>.multiple = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">numbers</span>){
  <span style="color: #00008b;">return</span> numbers.map((number) =&gt; number*<span style="color: #6b8e23;">this</span>.inc);
};

console.log(<span style="color: #00008b;">new</span> <span style="color: #36648b;">Multipler</span>(2).multiple([1,2,curry,es6]));<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; [ 2, es6, 6, 8 ]</span>
</pre>
</div>

<p>
ä¸éœ€è¦ <code>var self=this</code> äº†æ˜¯ä¸æ˜¯å¾ˆå¼€å¿ƒâ˜ºï¸ç°åœ¨, arrow function é‡Œé¢çš„
this ä¼šè‡ªåŠ¨ capture å¤–å±‚å‡½æ•°çš„ <code>this</code> å€¼.
</p>

<a class="jsbin-embed" href="https://jsbin.com/vawobe/1/embed?js,console">å®Œæ•´ä»£ç </a><script src="https://static.jsbin.com/js/embed.js"></script>
</div>
</div>
</div>

<div id="outline-container-org961f9c8" class="outline-3">
<h3 id="org961f9c8"><span class="section-number-3">2.2</span> JavaScriptçš„åŒ¿åå‡½æ•°(anonymous function)</h3>
<div class="outline-text-3" id="text-2-2">
<p>
æ”¯æŒåŒ¿åå‡½æ•°, ä¹Ÿå°±æ„å‘³ç€å‡½æ•°å¯ä»¥ä½œä¸ºä¸€ç­‰å…¬æ°‘. å¯ä»¥è¢«å½“åšå‚æ•°,
ä¹Ÿå¯ä»¥è¢«å½“åšè¿”å›å€¼.å› æ­¤, JavaScript çš„æ”¯æŒä¸€ç­‰å‡½æ•°çš„å‡½æ•°å¼è¯­è¨€,
è€Œä¸”å®šä¹‰ä¸€ä¸ªåŒ¿åå‡½æ•°å¼å¦‚æ­¤ç®€å•.
</p>
</div>

<div id="outline-container-org1733ae0" class="outline-4">
<h4 id="org1733ae0"><span class="section-number-4">2.2.1</span> åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
åœ¨JavaScripté‡Œåˆ›å»ºä¸€ä¸ªå‡½æ•°æ˜¯å¦‚æ­¤çš„ <del>ç®€å•</del> &#x2026; æ¯”å¦‚:
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">function</span>(<span style="color: #b8860b;">x</span>){
    <span style="color: #00008b;">return</span> x*x;
}<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; SyntaxError: function statement requires a name</span>
</pre>
</div>

<p>
ä½†æ˜¯, ä¸ºä»€ä¹ˆæŠ¥é”™äº†è¿™é‡Œ. å› ä¸ºåˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°éœ€è¦ç”¨è¡¨è¾¾å¼(function
expression). è¡¨è¾¾å¼æ˜¯ä¼šè¿”å›å€¼çš„:
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">a</span> = <span style="color: #00008b;">new</span> <span style="color: #36648b;">Array</span>() <span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">new Array &#26159;&#34920;&#36798;&#24335;, &#32780;&#36825;&#25972;&#34892;&#21483;&#35821;&#21477; statement</span>
</pre>
</div>

<p>
ä½†ä¸ºä»€ä¹ˆè¯´ <code>function statement requires a name</code>. å› ä¸º JavaScript
<b>è¿˜æœ‰ä¸€ç§</b> åˆ›å»ºå‡½æ•°çš„æ–¹æ³•--<i>function statement</i>.
è€Œåœ¨ä¸Šé¢è¿™ç§å†™æ³•ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ª function è¯­å¥, å› ä¸ºå¹¶æ²¡æœ‰æœŸå¾…å€¼. è€Œ
function è¯­å¥å£°æ˜æ˜¯éœ€è¦åå­—çš„.
</p>

<p>
ç®€å•å°†è¿™ä¸ªå‡½æ•°èµ‹ç»™ä¸€ä¸ªå˜é‡æˆ–å½“å‚æ•°ä¼ éƒ½ä¸ä¼šæŠ¥é”™,
å› ä¸ºè¿™æ—¶ä»–æ²¡æœ‰æ­§ä¹‰,åªèƒ½æ˜¯è¡¨è¾¾å¼.æ¯”å¦‚:
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">squareA</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">x</span>){
    <span style="color: #00008b;">return</span> x*x;
}
</pre>
</div>

<p>
ä½†æ˜¯è¿™é‡Œæ¯”è¾ƒ tricky çš„æ˜¯è¿™ä¸‹ <code>squareA</code> å…¶å®æ˜¯ä¸€ä¸ªå…·åå‡½æ•°äº†.
</p>

<pre class="example">
console.log(squareA) // =&gt; function squareA()
</pre>

<p>
è™½ç„¶ç»“æœæ˜¯å…·åå‡½æ•°,ä½†æ˜¯è¿‡ç¨‹å´ä¸ä¸‹é¢è¿™ç§å£°æ˜çš„æ–¹å¼ä¸ä¸€æ ·.
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">function</span> <span style="color: #6a5acd;">squareB</span>(<span style="color: #b8860b;">x</span>){
    <span style="color: #00008b;">return</span> x*x;
} <span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; undefined</span>
</pre>
</div>

<p>
<code>squareB</code> ç”¨çš„æ˜¯ function statement ç›´æ¥å£°æ˜(æ˜¾ç„¶ statement æ²¡æœ‰è¿”å›),
è€Œ <code>squareA</code> åˆ™æ˜¯å…ˆç”¨ function expression åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°,
ç„¶åå°†è¿”å›çš„å‡½æ•°èµ‹ç»™äº†åä¸º <code>squareA</code> çš„å˜é‡. å› ä¸ºè¡¨è¾¾å¼æ˜¯æœ‰è¿”å›çš„:
</p>

<div class="org-src-container">
<pre class="src src-js">console.log(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">x</span>){ <span style="color: #00008b;">return</span> x*x});
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; undefined</span>
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; function ()</span>
</pre>
</div>

<p>
ç¬¬ä¸€ä¸ª <code>undefined</code> æ˜¯ <code>console.log</code> çš„è¿”å›å€¼, å› æ­¤
<code>function()</code> åˆ™æ˜¯æ‰“å°å‡ºæ¥çš„ function è¡¨è¾¾å¼åˆ›å»ºçš„åŒ¿åå‡½æ•°.
</p>
</div>
</div>

<div id="outline-container-org3c72302" class="outline-4">
<h4 id="org3c72302"><span class="section-number-4">2.2.2</span> ä½¿ç”¨åŒ¿åå‡½æ•°</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
JavaScript çš„å‡½æ•°æ˜¯ä¸€ç­‰å‡½æ•°. è¿™æ„å‘³ç€æˆ‘ä»¬çš„å‡½æ•°è·Ÿå€¼çš„å¾…é‡æ˜¯ä¸€æ ·çš„,äºæ˜¯å®ƒ
</p>

<p>
å¯ä»¥èµ‹ç»™å˜é‡:
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">square</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">x</span>) {<span style="color: #00008b;">return</span> x*x}
</pre>
</div>

<p>
å¯ä»¥å½“å‚æ•°, å¦‚åˆšæ‰è§åˆ°çš„:
</p>

<div class="org-src-container">
<pre class="src src-js">console.log(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">x</span>){<span style="color: #00008b;">return</span> x*x})
</pre>
</div>

<p>
å°†å‡½æ•°ä¼ ç»™äº† <code>console.log</code>
</p>

<p>
å¯ä»¥è¢«è¿”å›:
</p>

<div class="org-src-container">
<pre class="src src-javascript"><span style="color: #00008b;">function</span> <span style="color: #6a5acd;">multiply</span>(<span style="color: #b8860b;">x</span>){
    <span style="color: #00008b;">return</span> <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">y</span>){
        <span style="color: #00008b;">return</span> x*y;
    }
}
multiply(1)(2) <span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; 2</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org589ddad" class="outline-2">
<h2 id="org589ddad"><span class="section-number-2">3</span> é«˜é˜¶å‡½æ•°(Higher-order function)</h2>
<div class="outline-text-2" id="text-3">
<p>
æˆ‘ä»¬å·²ç»è§è¯†åˆ°äº†åŒ¿åå‡½æ•°å’Œç®­å¤´å‡½æ•°çš„ç”¨æ³•, åŒ¿åçš„ä¸€ç­‰å‡½æ•°åˆ°åº•æœ‰ä»€ä¹ˆç”¨å‘¢?
æ¥çœ‹çœ‹é«˜é˜¶å‡½æ•°çš„åº”ç”¨.
</p>

<p>
é«˜é˜¶å‡½æ•°æ„æ€æ˜¯å®ƒæ¥æ”¶å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°. ä¸ºä»€ä¹ˆå« <b>é«˜é˜¶</b>: æ¥çœ‹çœ‹è¿™ä¸ªå‡½æ•°
<code>f(x, y) = x(y)</code> æŒ‰ç…§ lambda çš„ç®€åŒ–è¿‡ç¨‹åˆ™æ˜¯
</p>

<pre class="example">
f(x) =&gt; (y -&gt; x(y))
(y) =&gt; x(y)
</pre>

<p>
å¯ä»¥çœ‹å‡ºæ¥è°ƒç”¨ f æ—¶å´åˆè¿”å›äº†ä¸€ä¸ªå‡½æ•°x.
</p>

<p>
è¿˜è®°å¾—é«˜ç­‰æ•°å­¦é‡Œé¢çš„å¯¼æ•°å—, ä¸¤é˜¶ä»¥ä¸Šçš„å¯¼æ•°å«é«˜é˜¶å¯¼æ•°.
å› ä¸ºæ±‚å¯¼ä¸€æ¬¡ä»¥åè¿”å›çš„å¯ä»¥æ±‚å¯¼.
</p>

<p>
æ¦‚å¿µæ˜¯ä¸€æ ·çš„,
å¦‚åŒ<a href="https://en.wikipedia.org/wiki/Matryoshka_doll">ä¿„ç½—æ–¯å¥—å¨ƒ</a> å½“å‡½æ•°æ‰§è¡Œä»¥åè¿˜éœ€æ‰§è¡Œæˆ–è€…è¦å¯¹å‚æ•°æ‰§è¡Œ,
å› æ­¤å«é«˜é˜¶å‡½æ•°.
</p>


<figure>
<img src="./images/higherorder/recursion.png" alt="recursion.png">

</figure>

<p>
é«˜é˜¶å‡½æ•°æœ€å¸¸è§çš„åº”ç”¨å¦‚ <code>map</code>, <code>reduce</code>.
ä»–ä»¬éƒ½æ˜¯ä»¥ä¼ å…¥ä¸åŒçš„å‡½æ•°æ¥ä»¥ä¸åŒçš„æ–¹å¼æ“ä½œæ•°ç»„å…ƒç´ .
</p>

<p>
å¦å¤– <i>æŸ¯é‡ŒåŒ–</i>, åˆ™æ˜¯æ¯æ¬¡æ¶ˆè´¹ä¸€ä¸ªå‚æ•°å¹¶è¿”å›ä¸€ä¸ªé€æ­¥è¢«é…ç½®å¥½çš„å‡½æ•°.
</p>
<p>
é«˜é˜¶å‡½æ•°çš„è¿™äº›åº”ç”¨éƒ½æ˜¯ä¸ºå‡½æ•°çš„ç»„åˆæä¾›çµæ´»æ€§.
åœ¨æœ¬ç« ç»“æŸç›¸ä¿¡ä½ ä¼šå¾ˆå¥½çš„ä½“ä¼šåˆ°å‡½æ•°ç»„åˆçš„å¼ºå¤§ä¹‹å¤„.
</p>
</div>

<div id="outline-container-orgfb8a189" class="outline-3">
<h3 id="orgfb8a189"><span class="section-number-3">3.1</span> Higher-order function</h3>
<div class="outline-text-3" id="text-3-1">
<p>
å‡½æ•°åœ¨ JavaScript ä¸­æ˜¯ä¸€ç­‰å…¬æ°‘, å› æ­¤åœ¨ JavaScript ä¸­, ä½¿ç”¨é«˜é˜¶å‡½æ•°æ˜¯éå¸¸æ–¹ä¾¿çš„.
</p>
</div>

<div id="outline-container-orgc36b72f" class="outline-4">
<h4 id="orgc36b72f"><span class="section-number-4">3.1.1</span> å‡½æ•°ä½œä¸ºå‚æ•°</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
å‡è®¾æˆ‘ç°åœ¨è¦å¯¹ä¸€ä¸ªæ•°ç»„æ’åº, ç”¨æˆ‘ä»¬ç†Ÿæ‚‰çš„ <code>sort</code>
</p>

<div class="org-src-container">
<pre class="src src-js">[1,3,2,5,4].sort( (x, y) =&gt; x - y )
</pre>
</div>

<p>
å¦‚æœæˆ‘ä»¬è¦é€†åºçš„æ’åº, æŠŠå‡å·å·¦å³çš„ <code>x</code> å’Œ <code>y</code> å‘¼å”¤,å°±è¿™ä¹ˆç®€å•,
ä½†å¦‚æœæˆ‘æ˜¯ä¸€ä¸ªå¯¹è±¡æ•°ç»„, è¦æ ¹æ®å¯¹è±¡çš„ <code>id</code> æ’åº:
</p>

<div class="org-src-container">
<pre class="src src-js">[{id:1, name:<span style="color: #8b0000;">'one'</span>},
 {id:3, name:<span style="color: #8b0000;">'three'</span>}, 
 {id:2, name:<span style="color: #8b0000;">'two'</span>}, 
 {id:5, name:<span style="color: #8b0000;">'five'</span>},  
 {id:4, name:<span style="color: #8b0000;">'four'</span>}].sort((x,y) =&gt; x.id - y.id)
</pre>
</div>

<p>
æ˜¯ä¸æ˜¯å·²ç»èƒ½å¤Ÿæ„Ÿå—åˆ°é«˜é˜¶å‡½æ•°ä¸åŒ¿åå‡½æ•°ç»„åˆçš„çµæ´»æ€§.
</p>
</div>
</div>

<div id="outline-container-org9dcfa62" class="outline-4">
<h4 id="org9dcfa62"><span class="section-number-4">3.1.2</span> å‡½æ•°ä½œä¸ºè¿”å›å€¼</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
å‡½æ•°çš„è¿”å›å€¼å¯ä»¥ä¸åªæ˜¯å€¼, åŒæ ·ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°, æ¥çœ‹ Eweda
å†…éƒ¨çš„ä¸€ä¸ªå·¥å…·å‡½æ•° <code>aliasFor</code>, ä»–çš„ä½œç”¨æ˜¯ç»™å‡½æ•° E çš„ä¸€äº›æ–¹æ³•èµ·ä¸€äº›åˆ«å:
</p>

<div class="epigraph"><blockquote>
<p>
å¬èµ·æ¥å¾ˆæ€ªä¸æ˜¯å—, å‡½æ•°æ€ä¹ˆæœ‰æ–¹æ³•, å®é™…ä¸Š JavaScript çš„ <code>function</code>
æ˜¯ä¸€ä¸ªç‰¹æ®Š <b>å¯¹è±¡</b>, è¯•è¯•åœ¨ Firefox console é‡Œæ•² <code>console.log.</code>
æ˜¯ä¸æ˜¯çœ‹åˆ°äº†ä¸€äº›æ–¹æ³•, ä½†æ˜¯ <code>typeof console.log</code> æ˜¯ function
</p>

</blockquote></div>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">E</span> = () =&gt; {}
<span style="color: #00008b;">var</span> <span style="color: #b8860b;">aliasFor</span> = oldName =&gt; {
    <span style="color: #00008b;">var</span> <span style="color: #b8860b;">fn</span> = newName =&gt; {
      E[newName] = E[oldName];
      <span style="color: #00008b;">return</span> fn;
    };
    <span style="color: #00008b;">return</span> (fn.is = fn.are = fn.and = fn);
};
</pre>
</div>

<p>
è¿™é‡Œæœ‰ä¸¤ä¸ª <code>return</code>, ä¸€ä¸ªæ˜¯ <code>fn</code> è¿”å›è‡ªå·±, å¦ä¸€ä¸ªæ˜¯ <code>aliasFor</code> ä¹Ÿè¿”å›
<code>fn</code>, å¹¶ä¸”ç»™ <code>fn</code> äº†å‡ ä¸ªåˆ«å <code>fn.is</code> <code>fn.are</code>&#x2026;
</p>

<p>
ä»€ä¹ˆæ„æ€å‘¢? <code>fn</code> è¿”å› <code>fn</code>. å¾ˆç®€å•å°±æ˜¯ <code>fn() =&gt; fn</code>,
é‚£ä¹ˆ <code>fn()()=&gt;fn()=&gt;fn</code> &#x2026;ä»¥æ­¤ç±»æ¨, æ— è®ºè°ƒç”¨ fn å¤šå°‘æ¬¡,éƒ½æœ€ç»ˆè¿”å› fn.
</p>


<figure>
<img src="./images/higherorder/1qUCC8s.png" alt="1qUCC8s.png">

</figure>

<p>
è¿™åˆ°åº•æœ‰ä»€ä¹ˆç”¨å‘¢, ç”±äºè¿™é‡Œä½¿ç”¨äº† <code>fn</code> çš„å‰¯ä½œç”¨(side affect)
æ¥å¹²äº†ä¸€äº›äº‹æƒ… <code>E[newName]=E[oldName]</code>, ä¹Ÿå°±æ˜¯ç»™ E çš„æ–¹æ³•èµ·ä¸€ä¸ªåˆ«å,
å› æ­¤æ¯æ¬¡è°ƒç”¨ fn éƒ½ä¼šç»™ <code>E</code> èµ·ä¸€ä¸ªåˆ«å. <code>aliasFor</code> æœ€åè¿”å›çš„æ˜¯ <code>fn</code>
è‡ªå·±çš„ä¸€äº›åˆ«å, ä½¿å¾—å¯ä»¥ chain èµ·æ¥æ›´å¯è¯»ä¸€äº›:
</p>

<div class="org-src-container">
<pre class="src src-js">aliasFor(<span style="color: #8b0000;">'reduce'</span>).is(<span style="color: #8b0000;">'reduceLeft'</span>).is(<span style="color: #8b0000;">'foldl'</span>)
</pre>
</div>

<a class="jsbin-embed" href="https://jsbin.com/qohil/1/embed?js,console">å®Œæ•´ä»£ç </a><script src="https://static.jsbin.com/js/embed.js"></script>

<div class="epigraph"><blockquote>
<p>
å¦å¤–, å‡½æ•°ä½œä¸ºè¿”å›å€¼çš„é‡è¦åº”ç”¨, æŸ¯é‡ŒåŒ–ä¸é—­åŒ…,
å°†ä¼šåœ¨åœ¨åé¢ä¸“é—¨ä»‹ç». æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ä»¥å‡½æ•°ä½œä¸ºå‚æ•°çš„é«˜é˜¶å‡½æ•°çš„å…¸å‹åº”ç”¨.
</p>

</blockquote></div>
</div>
</div>
</div>

<div id="outline-container-orgc6fa5cf" class="outline-3">
<h3 id="orgc6fa5cf"><span class="section-number-3">3.2</span> æŸ¯é‡ŒåŒ– currying</h3>
<div class="outline-text-3" id="text-3-2">
<p>
è¿˜è®°å¾— Haskell Curryå—
</p>


<figure>
<img src="./images/higherorder/curry.png" alt="curry.png">

</figure>

<p>
å¤šå·§å•Š, äººå®¶å§“ Curry å Haskell, éš¾æ€ª Haskell è¯­è¨€ä¼šè‡ªåŠ¨æŸ¯é‡ŒåŒ–, å‘µå‘µ.
ä½†æ˜¯ä¸å¥‡æ€ªå—, ä¸ºä»€ä¹ˆè¦æŸ¯é‡ŒåŒ–å‘¢. ä¸ºä»€ä¹ˆå¦‚æ­¤é‡è¦å¾—è®© Haskell
ä¼šé»˜è®¤è‡ªåŠ¨æŸ¯é‡ŒåŒ–æ‰€æœ‰å‡½æ•°, ä¸å°±æ˜¯è¿”å›ä¸€ä¸ªéƒ¨åˆ†é…ç½®å¥½çš„å‡½æ•°å—.
</p>

<p>
æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª Haskell çš„ä»£ç .
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #6a5acd;">max</span> 3 4
(max 3) 4
</pre>
</div>

<p>
ç»“æœéƒ½æ˜¯4, è¿™æœ‰ä»€ä¹ˆç”¨å‘¢.
</p>

<p>
è¿™é‡Œçœ‹ä¸å‡ºæ¥, æ”¾åˆ° <code>é«˜é˜¶å‡½æ•°</code> è¯•è¯•. ä»€ä¹ˆ? çœ‹ä¸æ‡‚å¤©ä¹¦ Haskell, æ¥çœ‹çœ‹
JavaScript å§.
</p>
</div>

<div id="outline-container-org9d68875" class="outline-4">
<h4 id="org9d68875"><span class="section-number-4">3.2.1</span> æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªé—®é¢˜</h4>
<div class="outline-text-4" id="text-3-2-1">
</div>
<div id="outline-container-org4ef6c2b" class="outline-5">
<h5 id="org4ef6c2b">å†™ä¸€ä¸ªå‡½æ•°, å¯ä»¥è¿æ¥å­—ç¬¦æ•°ç»„, å¦‚ f(['1','2']) =&gt; '12'</h5>
<div class="outline-text-5" id="text-org4ef6c2b">
<p>
å¥½å§,å¦‚æœä¸ç”¨æŸ¯é‡ŒåŒ–, æ€ä¹ˆå†™? å•Šå“ˆ <code>reduce</code>
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">concatArray</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">chars</span>){
  <span style="color: #00008b;">return</span> chars.reduce(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">a</span>, <span style="color: #b8860b;">b</span>){
    <span style="color: #00008b;">return</span> a.concat(b);
  });
}
concat([<span style="color: #8b0000;">'1'</span>,<span style="color: #8b0000;">'2'</span>,<span style="color: #8b0000;">'3'</span>]) <span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; '123'</span>
</pre>
</div>

<p>
å¾ˆç®€å•,å¯¹å§.
</p>
</div>
</div>

<div id="outline-container-orgaae5a9c" class="outline-5">
<h5 id="orgaae5a9c">ç°åœ¨æˆ‘è¦å…¶ä¸­æ‰€æœ‰æ•°å­—åŠ 1, ç„¶ååœ¨è¿æ¥</h5>
<div class="outline-text-5" id="text-orgaae5a9c">
<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">concatArray</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">chars</span>, <span style="color: #b8860b;">inc</span>){
  <span style="color: #00008b;">return</span> chars.map(<span style="color: #00008b;">function</span>(<span style="color: #36648b;">char</span>){
    <span style="color: #00008b;">return</span> (+<span style="color: #36648b;">char</span>)+inc + <span style="color: #8b0000;">''</span>;
  }).reduce(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">a</span>,<span style="color: #b8860b;">b</span>){
      <span style="color: #00008b;">return</span> a.concat(b)
  });
}
console.log(concatArray([<span style="color: #8b0000;">'1'</span>,<span style="color: #8b0000;">'2'</span>,<span style="color: #8b0000;">'3'</span>], 1))<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; '234'</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfa21a85" class="outline-5">
<h5 id="orgfa21a85">æ‰€æœ‰æ•°å­—ä¹˜ä»¥2, å†é‡æ„è¯•è¯•çœ‹</h5>
<div class="outline-text-5" id="text-orgfa21a85">
<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">multiple</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">a</span>, <span style="color: #b8860b;">b</span>){
  <span style="color: #00008b;">return</span> +a*b + <span style="color: #8b0000;">''</span>
}
<span style="color: #00008b;">var</span> <span style="color: #b8860b;">concatArray</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">chars</span>, <span style="color: #b8860b;">inc</span>){
  <span style="color: #00008b;">return</span> chars.map(<span style="color: #00008b;">function</span>(<span style="color: #36648b;">char</span>){
    <span style="color: #00008b;">return</span> multiple(<span style="color: #36648b;">char</span>, inc);
  }).reduce(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">a</span>,<span style="color: #b8860b;">b</span>){
      <span style="color: #00008b;">return</span> a.concat(b)
  });
}
console.log(concatArray([<span style="color: #8b0000;">'1'</span>,<span style="color: #8b0000;">'2'</span>,<span style="color: #8b0000;">'3'</span>], 2)) <span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; '246'</span>
</pre>
</div>

<p>
æ˜¯ä¸æ˜¯å·²ç»çœ‹å‡ºé—®é¢˜äº†å‘¢?
å¦‚æœæˆ‘åœ¨éœ€è¦æ¯ä¸ªæ•°å­—éƒ½å‡2,æ˜¯ä¸æ˜¯å¾ˆéº»çƒ¦å‘¢.éœ€è¦å°† <code>map</code> å‚æ•°åŒ¿åå‡½æ•°ä¸­çš„
multiple å‡½æ•°æ¢æ‰. è¿™æ ·ä¸€æ¥ <code>concatArray</code> å°±ä¸èƒ½åŒæ—¶å¤„ç†åŠ , ä¹˜å’Œå‡?
é‚£ä¹ˆæ€ä¹ˆèƒ½æŠŠä»–æå–å‡ºæ¥å‘¢? æ¥å¯¹æ¯”ä¸‹æŸ¯é‡ŒåŒ–çš„è§£æ³•.
</p>
</div>
</div>
</div>

<div id="outline-container-orgb2b4305" class="outline-4">
<h4 id="orgb2b4305"><span class="section-number-4">3.2.2</span> æŸ¯é‡ŒåŒ–å‡½æ•°æ¥å£</h4>
<div class="outline-text-4" id="text-3-2-2">
<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">multiple</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">a</span>){
  <span style="color: #00008b;">return</span> <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">b</span>){
    <span style="color: #00008b;">return</span> +b*a + <span style="color: #8b0000;">''</span>
  }
}

<span style="color: #00008b;">var</span> <span style="color: #b8860b;">plus</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">a</span>){
  <span style="color: #00008b;">return</span> <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">b</span>){
    <span style="color: #00008b;">return</span> (+b)+a + <span style="color: #8b0000;">''</span>
  }
}
<span style="color: #00008b;">var</span> <span style="color: #b8860b;">concatArray</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">chars</span>, <span style="color: #b8860b;">stylishChar</span>){
  <span style="color: #00008b;">return</span> chars.map(stylishChar)
    .reduce(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">a</span>,<span style="color: #b8860b;">b</span>){
      <span style="color: #00008b;">return</span> a.concat(b)
  });
}
console.log(concatArray([<span style="color: #8b0000;">'1'</span>,<span style="color: #8b0000;">'2'</span>,<span style="color: #8b0000;">'3'</span>], multiple(2)))
console.log(concatArray([<span style="color: #8b0000;">'1'</span>,<span style="color: #8b0000;">'2'</span>,<span style="color: #8b0000;">'3'</span>], plus(2)))
</pre>
</div>

<p>
æœ‰ä»€ä¹ˆä¸ä¸€æ ·å‘¢ 1. å¤„ç†æ•°ç»„ä¸­å­—ç¬¦çš„å‡½æ•°è¢«æå–å‡ºæ¥, ä½œä¸ºå‚æ•°ä¼ å…¥ 2.
æå–æˆæŸ¯é‡ŒåŒ–çš„å‡½æ•°, éƒ¨åˆ†é…ç½®å¥½åä¼ å…¥, å¥½å¤„æ˜¾è€Œæ˜“è§, è¿™ä¸‹æ¥å£éå¸¸é€šç•…
æ— è®ºæ˜¯å¤–å±‚è°ƒç”¨
</p>

<pre class="example">
concatArray(['1','2','3'], multiple(2))
</pre>

<p>
è¿˜æ˜¯å†…éƒ¨çš„ map å‡½æ•°
</p>

<pre class="example">
chars.map(stylishChar)
</pre>

<p>
è¿™äº›æ¥å£éƒ½æ¸…æ™°äº†å¾ˆå¤š, ä¸æ˜¯å—
</p>

<p>
è¿™å°±æ˜¯å‡½æ•°å¼çš„æ€æƒ³, ç”¨å·²æœ‰çš„å‡½æ•°ç»„åˆå‡ºæ–°çš„å‡½æ•°, è€ŒæŸ¯é‡ŒåŒ–æ¯æ¶ˆè´¹ä¸€ä¸ªå‚æ•°,
éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„éƒ¨åˆ†é…ç½®çš„å‡½æ•°, è¿™ä¸ºå‡½æ•°ç»„åˆæä¾›äº†æ›´çµæ´»çš„æ‰‹æ®µ,
å¹¶ä¸”ä½¿å¾—æ¥å£æ›´ä¸ºæµç•….
</p>
</div>
</div>

<div id="outline-container-org5118c19" class="outline-4">
<h4 id="org5118c19"><span class="section-number-4">3.2.3</span> è‡ªåŠ¨æŸ¯é‡ŒåŒ–</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
åœ¨ Haskell è¯­è¨€ä¸­, å‡½æ•°æ˜¯ä¼šè‡ªåŠ¨æŸ¯é‡ŒåŒ–çš„:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #6a5acd;">max</span> 3 4
</pre>
</div>

<p>
å…¶å®å°±æ˜¯
</p>

<pre class="example">
(max 3) 4
</pre>

<p>
å¯ä»¥çœ‹çœ‹ <code>max</code> ä¸ <code>max 3</code> å‡½æ•°çš„ ç±»å‹
</p>

<div class="org-src-container">
<pre class="src src-haskell">ghci<span style="color: #6a5acd;">&gt;</span> <span style="color: #36648b;">:</span>t max
<span style="color: #6a5acd;">max</span> <span style="color: #b8860b;">::</span> <span style="color: #36648b;">Ord</span> a <span style="color: #b8860b;">=&gt;</span> a <span style="color: #b8860b;">-&gt;</span> a <span style="color: #b8860b;">-&gt;</span> a
</pre>
</div>

<p>
çœ‹æ˜ç™½äº†ä¹ˆ, <code>Ord a =&gt;</code> è¡¨ç¤ºç±»å‹çº¦æŸä¸ºå¯ä»¥æ¯”è¾ƒå¤§å°çš„ç±»å‹, å› æ­¤ <code>max</code>
çš„ç±»å‹å¯ä»¥ç¿»è¯‘æˆ: å½“ç»™å®šä¸€ä¸ª <code>a</code>, ä¼šå¾—åˆ° <code>a -&gt; a</code>,
å†çœ‹çœ‹ <code>max 3</code> çš„ç±»å‹å°±å¥½ç†è§£äº†
</p>

<pre class="example">
ghci&gt; :t max 3
(Num a, Ord a) =&gt; a -&gt; a
</pre>

<p>
å·¦ä¾§è¡¨ç¤ºç±»å‹çº¦æŸ <code>a</code> å¯ä»¥æ˜¯ <code>Ord</code> æˆ–è€… <code>Num</code>,
æ„æ€æ˜¯ <code>max 3</code> è¿˜æ˜¯ä¸€ä¸ªå‡½æ•°,å¦‚æœç»™å®šä¸€ä¸ª <code>Ord</code> æˆ–è€… <code>Num</code> ç±»å‹çš„å‚æ•°
åˆ™è¿”å›ä¸€ä¸ª <code>Ord</code> æˆ–è€… <code>Num</code>.
</p>

<p>
ç°åœ¨æ˜¯ä¸æ˜¯æ¸…æ™°äº†, åœ¨ Haskell ä¸­æ¯ç»™å®šä¸€ä¸ªå‚æ•°, å‡½æ•°å¦‚æœæ˜¯å¤šå‚æ•°çš„,
è¯¥å‡½æ•°è¿˜ä¼šè¿”å›ä¸€ä¸ªå¤„ç†ä½™ä¸‹å‚æ•°çš„å‡½æ•°. è¿™å°±æ˜¯è‡ªåŠ¨æŸ¯é‡ŒåŒ–.
</p>

<p>
è€Œåœ¨ Javascript(ä»¥åŠå¤§å¤šæ•°è¯­è¨€) ä¸­ä¸æ˜¯çš„, å¦‚æœç»™å®šå¤šå‚å‡½æ•°çš„éƒ¨åˆ†å‚æ•°,
å‡½æ•°ä¼šé»˜è®¤å…¶ä»–å‚æ•°æ˜¯ <code>undefined</code>, è€Œä¸ä¼šè¿”å›å¤„ç†å‰©ä½™å‚æ•°çš„å‡½æ•°.
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">function</span> <span style="color: #6a5acd;">willNotCurry</span>(<span style="color: #b8860b;">a</span>, <span style="color: #b8860b;">b</span>, <span style="color: #b8860b;">c</span>) {
    console.log(a, b, c)
    <span style="color: #00008b;">return</span> a*b-c;
}
willNotCurry(1)
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; NaN</span>
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; 1 undefined undefined</span>
</pre>
</div>

<p>
å¦‚æœä½¿ç”¨è‡ªåŠ¨æŸ¯é‡ŒåŒ–çš„åº“ <a href="https://github.com/CrossEye/eweda">eweda</a>,
å‰é¢çš„ä¾‹å­ç®€ç›´å°±å®Œç¾äº†
</p>

<pre class="example">
var multiple = curry(function(a, b){
  return +b*a + ''
})
var plus = curry(function(a, b){
  return (+b)+a + ''
})
</pre>

<a class="jsbin-embed" href="https://jsbin.com/hamoq/6/embed?js,console">å®Œæ•´ä»£ç </a><script src="https://static.jsbin.com/js/embed.js"></script>
</div>
</div>
</div>

<div id="outline-container-org5a78310" class="outline-3">
<h3 id="org5a78310"><span class="section-number-3">3.3</span> å‡½æ•°ç»„åˆ function composition</h3>
<div class="outline-text-3" id="text-3-3">
<p>
é€šè¿‡å‰é¢ä»‹ç»çš„é«˜é˜¶å‡½æ•°, map, fold ä»¥åŠæŸ¯é‡ŒåŒ–,
å…¶å®å·²ç»è§è¯†åˆ°ä»€ä¹ˆæ˜¯å‡½æ•°ç»„åˆäº†. å¦‚ä¹‹å‰ä¾‹å­ä¸­çš„ map å°±æ˜¯ ç”± fold å‡½æ•°ä¸
reverse å‡½æ•°ç»„åˆå‡ºæ¥çš„.
</p>

<p>
è¿™å°±æ˜¯å‡½æ•°å¼çš„æ€æƒ³, ä¸æ–­åœ°ç”¨å·²æœ‰å‡½æ•°, æ¥ç»„åˆå‡ºæ–°çš„å‡½æ•°.
</p>


<figure>
<img src="./images/higherorder/composition.jpg" alt="composition.jpg">

</figure>

<p>
å¦‚å›¾å°±æ˜¯å‡½æ•°ç»„åˆï¼Œæ¥è‡ª
<a href="https://en.wikipedia.org/wiki/Category_theory">Catgory Theory</a>ï¼ˆFuntor ä¹Ÿæ˜¯ä»è¿™æ¥çš„ï¼Œåé¢ä¼šè®²åˆ°ï¼‰, æ—¢ç„¶ä» Aåˆ°B
æœ‰å¯¹åº”çš„æ˜ å°„fï¼ŒBåˆ° Cæœ‰å¯¹åº”çš„æ˜ å°„gï¼Œ é‚£ä¹ˆ <code>(g.f)(x)</code> ä¹Ÿå°±æ˜¯ <code>f</code> ä¸ <code>g</code>
çš„ç»„åˆ <code>g(f(x))</code> å°±æ˜¯ Aåˆ° C çš„æ˜ å°„ã€‚ä¸Šä¸€ç« å®ç°çš„ map å‡½æ•°å°±ç›¸å½“äº
<code>reverse.fold</code>.
</p>
</div>

<div id="outline-container-org60201ca" class="outline-4">
<h4 id="org60201ca"><span class="section-number-4">3.3.1</span> Compose</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
æˆ‘ä»¬å¯ä»¥ç”¨ Eweda éå¸¸æ–¹ä¾¿çš„ compose æ–¹æ³•æ¥ç»„åˆå‡½æ•°
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">gf</span> = E.compose(f, g)
</pre>
</div>

<p>
è¯´åˆ°äº†å‡½æ•°ç»„åˆ, æŸ¯é‡ŒåŒ–, æˆ‘æƒ³ç°åœ¨ç»ˆäºå¯ä»¥è§£é‡Šæ¸…æ¥šä¸ºä»€ä¹ˆåœ¨è¿™é‡Œé€‰ç”¨
Eweda/Ramda è€Œä¸æ˜¯ Underscore äº†.
</p>

<p>
ä¸¾ä¸ªä¾‹å­ğŸŒ° å¦‚æœæˆ‘ç°åœ¨æƒ³è¦ tasks åˆ—è¡¨ä¸­æ‰€æœ‰å±æ€§ä¸º <code>completed</code> ä¸º <code>true</code>
çš„å…ƒç´ , å¹¶æŒ‰ç…§ <code>id</code> æ’åº.
</p>

<p>
underscore é‡Œä¼šè¿™æ ·å†™:
</p>

<div class="org-src-container">
<pre class="src src-js">_(tasks)
    .chain()
    .filter( task =&gt; task.completed===<span style="color: #6b8e23;">true</span>)
    .sortBy( task =&gt; task.id)
    .value();
</pre>
</div>

<p>
è¿™ç§æ–¹å¼æ€ä¹ˆçœ‹éƒ½ä¸æ˜¯å‡½æ•°å¼, è€Œæ˜¯ä»¥å¯¹è±¡/å®¹å™¨ä¸ºä¸­å¿ƒçš„ä¸²è”ï¼Œæœ‰äº›åƒ jquery
å¯¹è±¡çš„é“¾å¼è°ƒç”¨, æˆ–è€…æˆ‘ä»¬å¯ä»¥å†™çš„å‡½æ•°å¼ä¸€äº›, å¦‚
</p>

<div class="org-src-container">
<pre class="src src-js">_.sortBy(_.filter(tasks, task =&gt; task.completed===<span style="color: #6b8e23;">true</span>), task =&gt; task.id)
</pre>
</div>

<p>
æ©æ©, çœ‹èµ·æ¥ä¸é”™å˜›, ä½†æ˜¯æœ‰è°æ˜¯è¿™ä¹ˆç”¨ underscoreçš„å‘¢. ä¸€èˆ¬éƒ½ä¼šåªè§è¿‡
é“¾å¼è°ƒç”¨æ‰æ˜¯ underscore çš„æ ‡å‡†å†™æ³•ã€‚
</p>

<p>
æ¥å¯¹æ¯”ä¸€ä¸‹ç”¨ Eweda/Ramda è§£å†³çš„è¿‡ç¨‹ :
</p>

<div class="org-src-container">
<pre class="src src-js">compose(sortBy(task=&gt;task.id), filter(task=&gt;task.completed===<span style="color: #6b8e23;">true</span>))(tasks)
</pre>
</div>

<p>
å¥½åƒæ²¡ä»€ä¹ˆåŒºåˆ«å•Š? ä¸å°±æ˜¯ç”¨äº† compose å—?
</p>

<p>
åŒºåˆ«å¤§äº†è¿™, çœ‹è§ <code>tasks</code> æ˜¯æœ€åå½“å‚æ•°ä¼ ç»™ <code>E.compose()</code> çš„å—?
è€Œä¸æ˜¯å†™æ­»åœ¨filter çš„å‚æ•°ä¸­. è¿™æ„å‘³ç€åœ¨æ¥åˆ°éœ€è¦å¤„ç†çš„æ•°æ®å‰,
æˆ‘å·²ç»ç»„åˆå¥½ä¸€ä¸ªæ–°çš„å‡½æ•°åœ¨ç­‰å¾…æ•°æ®, è€Œä¸æ˜¯æŠŠæ•°æ®æ··æ‚åœ¨ä¸­é—´,
æˆ–æ˜¯ä¿æŒåœ¨ä¸€ä¸ªä¸­é—´å¯¹è±¡ä¸­. è€Œ underscore
çš„å†™æ³•å¯¼è‡´è¿™ä¸€é•¿ä¸² <code>_.sortBy(_.filter())</code> å…¶å®æ ¹æœ¬æ— æ³•é‡ç”¨ã€‚
</p>

<p>
å¥½å§å¦‚æœä½ è¿˜çœ‹ä¸å‡ºæ¥è¿™æ ·åšçš„å¥½å¤„. é‚£ä¹ˆæ¥å¦‚æœæˆ‘æœ‰ä¸€ä¸ªåŒ…å«å‡ ç»„ tasksçš„åˆ—è¡¨
groupedTasks, æˆ‘è¦æŒ‰ç±»å‹é€‰å‡º completed ä¸º true å¹¶æŒ‰ id æ’åº.
å¦‚æˆ‘ç°åœ¨æ•°æ®æ˜¯è¿™ä¸ªï¼š
</p>

<pre class="example">
groupedTasks = [
  [{completed:false, id:1},{completed:true, id:2}],
  [{completed:false, id:4},{completed:true, id:3}]
]
</pre>

<p>
underscore:
</p>

<div class="org-src-container">
<pre class="src src-js">_.map(groupedTasks,
   tasks =&gt; _.sortBy(_.filter(tasks, task =&gt; task.completed===<span style="color: #6b8e23;">true</span>), task =&gt; task.id))
</pre>
</div>

<p>
çœ‹è§æˆ‘ä»¬åˆæŠŠ <code>_.sortBy(_.filter())</code> è¿™ä¸€é•¿ä¸²åŸå°ä¸åŠ¨çš„æ‹·è´åˆ°äº† map é‡Œã€‚
å› ä¸º underscore
ä¸€å¼€å§‹å°±è¦æ¶ˆè´¹æ•°æ®ï¼Œä½¿å¾—å¾ˆéš¾é‡ç”¨ï¼Œé™¤éåœ¨å¥—åœ¨å¦ä¸€ä¸ªå‡½æ•°é‡Œï¼š
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">function</span> <span style="color: #6a5acd;">completedAndSorted</span>(<span style="color: #b8860b;">tasks</span>){
  <span style="color: #00008b;">return</span> _.sortBy(_.filter(tasks, task =&gt; task.completed===<span style="color: #6b8e23;">true</span>), task =&gt; task.id))
}
_.map(groupedTasks, completedAndSorted)
</pre>
</div>

<p>
åªæœ‰è¿™æ ·æ‰èƒ½é‡ç”¨å·²æœ‰çš„ä¸€äº›å‡½æ•°ã€‚æˆ–è€…è™½ç„¶ underscore ä¹Ÿæœ‰ <code>_.compose</code>
æ–¹æ³•ï¼Œä½†æ˜¯ å‡ ä¹æ‰€æœ‰ underscore
çš„æ–¹æ³•éƒ½æ˜¯å…ˆæ¶ˆè´¹æ•°æ®ï¼ˆä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°æ®ï¼‰ï¼Œä½¿å¾—å¾ˆéš¾æ”¾åˆ° <code>compose</code>
æ–¹æ³•ä¸­ï¼Œä¸ä¿¡å¯ä»¥å°è¯•æŠŠ filter å’Œ sortBy æè¿›å»ï¼Œåæ­£æˆ‘æ˜¯åšä¸åˆ°ã€‚
</p>

<p>
æ¥çœ‹çœ‹çœŸæ­£çš„å‡½æ•°ç»„åˆ
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">completedAndSorted</span> = compose(sortBy(task=&gt;task.id),
                                 filter(task=&gt;task.completed===<span style="color: #6b8e23;">true</span>))
map(completedAndSorted, groupedTasks)
</pre>
</div>

<p>
çœ‹å‡ºæ¥æ€æƒ³å®Œå…¨ä¸ä¸€æ ·äº†å§.
</p>

<p>
ç”±äº Eweda/Ramda çš„å‡½æ•°éƒ½æ˜¯è‡ªåŠ¨æŸ¯é‡ŒåŒ–,è€Œä¸”æ•°æ®æ€»æ˜¯æœ€åä¸€ä¸ªå‚æ•°,
å› æ­¤å¯ä»¥éšæ„ç»„åˆ, æœ€ç»ˆå°†éœ€è¦å¤„ç†çš„æ•°æ®æ‰”ç»™ç»„åˆå¥½çš„å‡½æ•°å°±å¥½äº†.
è¿™æ‰æ˜¯å‡½æ•°å¼çš„æ€æƒ³. å…ˆå†™å¥½ä¸€ä¸ªå…¬å¼ï¼Œåœ¨æŠŠæ•°æ®æ‰”ç»™
å…¬å¼ã€‚è€Œä¸æ˜¯ç®—å¥½ä¸€éƒ¨åˆ†å†æŠŠç»“æœç»™å¦ä¸€ä¸ªå…¬å¼ã€‚
</p>


<figure>
<img src="./images/higherorder/ThreeFunctionMachines.jpg" alt="ThreeFunctionMachines.jpg">

</figure>

<p>
è€Œ underscore è¦ä¹ˆæ˜¯ä»¥å¯¹è±¡ä¿æŒä¸­é—´æ•°æ®, ç”¨ chaining
çš„æ–¹å¼å¯¹ç›®æ ‡åº”ç”¨å„ç§å‡½æ•°ï¼ˆä¹¦ä¸Šä¼šå†™è¿™æ˜¯Flow-Base
programmingï¼Œä½†æˆ‘è§‰å¾—å…¶å®æ˜¯ Monadï¼Œä¼šåœ¨ä¸‹ä¸€ç« ä¸­ä»‹ç»ï¼‰,
è¦ä¹ˆç”¨å‡½æ•°åµŒå¥—å‡½æ•°, å°†ç›®æ ‡ä¸€å±‚å±‚ä¼ é€’ä¸‹å».
</p>
</div>
</div>

<div id="outline-container-org1eed985" class="outline-4">
<h4 id="org1eed985"><span class="section-number-4">3.3.2</span> pipe</h4>
<div class="outline-text-4" id="text-3-3-2">
<p>
ç±»ä¼¼ compose, eweda/ramda è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•å« pipe, pipe çš„å‡½æ•°æ‰§è¡Œæ–¹å‘åˆšå¥½ä¸
compose ç›¸å. æ¯”å¦‚ <code>pipe(f, g)</code>, <code>f</code> ä¼šå…ˆæ‰§è¡Œ, ç„¶åç»“æœä¼ ç»™ <code>g</code>,
æ˜¯ä¸æ˜¯è®©ä½ æƒ³èµ·äº† bash çš„ pipe
</p>

<pre class="example">
find / | grep porno
</pre>

<p>
å®é™…ä¸Šå°±æ˜¯ <code>pipe(find, grep(porno))(/)</code>
</p>

<p>
æ²¡é”™,ä»–ä»¬éƒ½æ˜¯ä¸€ä¸ªæ„æ€. è€Œä¸”è¿™ä¸ªå‡½æ•°æ‰§è¡Œçš„æ–¹å‘æ›´é€‚åˆäººè„‘ç¼–è¯‘(å¯è¯»)ä¸€äº›.
</p>

<p>
å¦‚æœä½ å·²ç»ä¹ æƒ¯ underscore çš„è¿™ç§å†™æ³•
</p>

<div class="org-src-container">
<pre class="src src-js">_(data)
  .chain()
  .map(data1,fn1)
  .filter(data2, fn2)
  .value()
</pre>
</div>

<p>
é‚£ä¹ˆè½¬æ¢æˆ pipe æ˜¯å¾ˆå®¹æ˜“çš„ä¸€ä»¶äº‹æƒ…ï¼Œè€Œä¸”æ›´ç®€å•æ˜äº†æ˜“äºé‡ç”¨å’Œç»„åˆã€‚
</p>

<div class="org-src-container">
<pre class="src src-js">pipe(
  map(fn1),
  filter(fn2)
)(data)
</pre>
</div>

<a class="jsbin-embed" href="https://jsbin.com/hivaje/2/embed?js,console">å®Œæ•´ä»£ç </a><script src="https://static.jsbin.com/js/embed.js"></script>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd96bfe5" class="outline-2">
<h2 id="orgd96bfe5"><span class="section-number-2">4</span> Transducers</h2>
<div class="outline-text-2" id="text-4">
<p>
é€šè¿‡ä¸Šä¸€ç¯‡<a href="./clojure-core.async-essence-in-native-javascript.html">Clojureé£æ ¼çš„JavaScriptå¹¶å‘ç¼–ç¨‹</a>ä»‹ç»äº†å¦‚ä½•ç”¨JavaScriptäº«å—åˆ°Clojureåœ¨å¹¶å‘ç¼–ç¨‹çš„ä¼˜åŠ¿. æˆ‘å†³å®š
å†™ä¸€ç³»åˆ—å…³äºå¦‚ä½•ç”¨JavaScriptç©è½¬Clojureå¤§æ³•çš„æ–‡ç« . è¿™å›è¦ç”¨JavaScriptç©è½¬å¦ä¸€ä¸ª
Clojureå…¨æ–°çš„æ¦‚å¿µ &#x2013; <i>Transducer</i>.
</p>

<p>
Transducer æ˜¯ Rich Hickey<label for="6" class="margin-toggle sidenote-number"></label><input type="checkbox" id="6" class="margin-toggle"/><span class="sidenote">
Clojureçš„ä½œè€…
</span> <a href="http://blog.cognitect.com/blog/2014/8/6/transducers-are-coming">é«˜è°ƒå®£å¸ƒ</a> çš„åœ¨Clojure 1.7 ç‰ˆæœ¬åŠ å…¥çš„åˆä¸€å¤§æ³•. åœ¨ä¹‹å‰çš„å¦ä¸€ä¸ªæ¦‚å¿µ
<a href="http://clojure.com/blog/2012/05/15/anatomy-of-reducer.html">Reducer</a> å´æ²¡é‚£ä¹ˆ <b>é«˜è°ƒ</b>. åœ¨è§£é‡Štransducerä¹‹å‰, å…ˆçœ‹çœ‹ä»€ä¹ˆæ˜¯Reducer, å¦‚æœèƒ½çœ‹æ‡‚, å†æ¥ç€çœ‹Transducer.
</p>
</div>

<div id="outline-container-orgbfe0537" class="outline-3">
<h3 id="orgbfe0537"><span class="section-number-3">4.1</span> Reducer</h3>
<div class="outline-text-3" id="text-4-1">
<p>
è¯´é“reduceè¿™ä¸ªè¯, æƒ³å¿…JS Developerå¤§å¤šä¼šç”¨è¿‡underscore<label for="7" class="margin-toggle sidenote-number"></label><input type="checkbox" id="7" class="margin-toggle"/><span class="sidenote">
æˆ‘æ˜¯æ•…æ„å§reduceçš„å‚æ•°é¡ºåºå†™"å"çš„, åŸæ¥underscoreæ˜¯å…ˆæ¶ˆè´¹collectionçš„. è‡³äºä¸ºä»€ä¹ˆè¦åè¿‡æ¥
å¯ä»¥å‚è€ƒ<a href="https://blog.oyanglul.us/javascript/functional-javascript.html#sec-3-2">è¿™ä¸ªè§£é‡Š</a>
</span>(æˆ–ç±»ä¼¼)çš„reduceæ–¹æ³•, å¤§æ¦‚å½¢å¼æ˜¯è¿™æ ·
</p>
<div class="org-src-container">
<pre class="src src-js">_.reduce(fn, 0, [1,2,3])
</pre>
</div>
<p>
å¤§æ¦‚æ„æ€æ˜¯åˆå§‹ä¸º0, åº”ç”¨fnåˆ°æ¯ä¸€ä¸ªcollection(æ£€æµ‹coll)å…ƒç´ ä¸Š,å¾—åˆ°ä¸€ä¸ªæ–°çš„å€¼.
</p>

<p>
å¦‚æœåŠ ä¸Šmap, æ¯”å¦‚(æˆ‘è¦å¼€å§‹ç”¨<a href="https://github.com/swannodette/mori">mori</a><label for="8" class="margin-toggle sidenote-number"></label><input type="checkbox" id="8" class="margin-toggle"/><span class="sidenote">
clojurescriptä½œè€…æŠŠclojurescriptçš„ä¸€äº›æ•°æ®ç»“æ„å’Œå‡½æ•°ç¼–è¯‘æˆjavascript, è¿™æ ·å°±å¯ä»¥ç”¨æ™®é€šjsä½¿ç”¨
clojureä¸­çš„æ•°æ®ç»“æ„å’Œå‡½æ•°. documentä¸¥é‡è¿‡æ—¶, å»ºè®®çœ‹å¯¼å…¥çš„<a href="https://github.com/swannodette/mori/blob/master/src/mori.cljs">æºä»£ç </a>, ä»¥åŠclojureçš„æ–‡æ¡£, æ¥å£å’ŒclojureåŸºæœ¬ä¸€è‡´.
</span> äº†)
</p>
<div class="org-src-container">
<pre class="src src-javascript">reduce(sum, 0, map(inc [1,2,3]))
</pre>
</div>

<div class="epigraph"><blockquote>
<p>
Terminology:
</p>
<ol class="org-ol">
<li>reducing å‡½æ•°: ç”¨æ¥reduceçš„å‡½æ•°, æ¯”å¦‚sum</li>
<li>transform: å˜æ¢, ä»ä¸€ä¸ªå‡½æ•°å˜å¦ä¸€ä¸ªå‡½æ•°</li>
<li>xf: xform, transform å‡½æ•°</li>
<li>reducible: å¯è¢«reduceçš„,ä¹Ÿå°±æ˜¯å®ç°reduceæ¥å£çš„,æ¯”å¦‚æ‰€æœ‰çš„collection</li>
</ol>

</blockquote></div>

<p>
è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥åˆ†æä¸€ä¸‹è¿™æ¬¡reduceåˆ°åº•å¹²äº†ä»€ä¹ˆ
</p>
<ol class="org-ol">
<li>map å‡½æ•° inc åˆ° coll æ¯ä¸€ä¸ªå…ƒç´ , å¾—åˆ°ä¸€ä¸ªæ–°çš„ coll <code>[2,3,4]</code></li>
<li>reduce æŠŠæ–°collçš„æ¯ä¸ªå…ƒç´ ç”¨sumå‡½æ•°, å¾—åˆ°ä¸€ä¸ªæ–°çš„å€¼.</li>
</ol>

<p>
å¥½å§è¿™å°±æ˜¯reduceäº†, ç”¨ä¸€ä¸ªreducingå‡½æ•°sumå»è®¡ç®—collå¾—å‡ºä¸€ä¸ªæ–°çš„å€¼.
</p>

<p>
æ¥çœ‹çœ‹æ›´å¥½çš„è§£æ³•
</p>
</div>
<div id="outline-container-org71dbcb7" class="outline-4">
<h4 id="org71dbcb7"><span class="section-number-4">4.1.1</span> transform</h4>
<div class="outline-text-4" id="text-4-1-1">
<p>
reduceå‡½æ•°éœ€è¦ç­‰å¾…mapè¿”å›æ–°çš„collåæ‰èƒ½reduce, é‚£ä¹ˆå¯ä¸å¯ä»¥ä¸€æ­¥ç›´æ¥ç®—å‡ºæ¥å‘¢?
</p>

<p>
å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•°xfå¯ä»¥å˜æ¢reducingå‡½æ•°(ä¸Šä¾‹çš„sumæ˜¯reducingå‡½æ•°)çš„å½¢å¼, æ¯”å¦‚
</p>
<pre class="example">
xf(reduceFn) -&gt; anotherReduceFn
</pre>

<p>
å†å‡å¦‚æˆ‘ä»¬çš„æ–°mapå‡½æ•°å¯ä»¥åšè¿™ç§è½¬æ¢
</p>
<div class="org-src-container">
<pre class="src src-javascript">map(inc)(sum) -&gt; aShinyNewReduceFn
</pre>
</div>

<div class="epigraph"><blockquote>
<p>
map å‡½æ•°çš„ç®€å•transformå®ç°å¯ä»¥è¿™æ ·å®ç°,å¦‚æœä½ æ„Ÿå…´è¶£çš„è¯
</p>
<div class="org-src-container">
<pre class="src src-javascript"><span style="color: #00008b;">function</span> <span style="color: #6a5acd;">map</span>(<span style="color: #b8860b;">fn</span>){
  <span style="color: #00008b;">return</span> <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">reduceFn</span>){
    <span style="color: #00008b;">return</span> <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">result</span>, <span style="color: #b8860b;">input</span>){
      reduceFn(result, fn(input))
    }
  }
}
</pre>
</div>

</blockquote></div>

<p>
é‚£ä¹ˆæˆ‘ä»¬ä¹‹å‰çš„reduceå°±å¯ä»¥å†™æˆ
</p>

<div class="org-src-container">
<pre class="src src-javascript">reduce(map(inc)(sum),0,[1,2,3])
</pre>
</div>

<p>
yeah, ç°åœ¨åªéœ€è¦ä¸€æ­¥å°±reduceå‡ºæ¥ç»“æœäº†, reduceåº”ç”¨ <code>map(inc)(sum)</code> æ¥è®¡ç®—å€¼, åªéœ€è¦éå†ä¸€écoll
</p>
</div>
</div>

<div id="outline-container-org5444796" class="outline-4">
<h4 id="org5444796"><span class="section-number-4">4.1.2</span> <a href="https://clojure.org/reducers">Reducer</a></h4>
<div class="outline-text-4" id="text-4-1-2">
<p>
ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸æƒ³æ”¹å˜mapå‡½æ•°çš„æ¥å£, åŸå§‹å½¢å¼çš„æ¥å£è¿˜æ˜¯æ¯”è¾ƒå¥½å†™å¥½è¯»çš„
</p>
<div class="org-src-container">
<pre class="src src-javascript">reduce(sum, 0, map(inc [1,2,3]))
</pre>
</div>
<p>
é‚£ä¹ˆéœ€è¦è¿›ä¸€æ­¥çš„æŠ½è±¡, æˆ‘æŠŠæ–°çš„mapå‡½æ•°å«åšrmapå¥½äº†
</p>
<div class="org-src-container">
<pre class="src src-javascript"><span style="color: #00008b;">function</span> <span style="color: #6a5acd;">rmap</span>(<span style="color: #b8860b;">fn</span>, <span style="color: #b8860b;">coll</span>){
  reducer(coll, map(fn))
}
</pre>
</div>
<p>
è·Ÿä»¥å‰æ¥å£ä¸€æ ·,æ¥æ”¶å‡½æ•°å’Œcoll,ä½†æ˜¯è¿”å›ä¸€ä¸ªç”±reducerç”Ÿæˆçš„reducible, æ‰€ä»¥å°±å˜æˆäº†
</p>
<div class="org-src-container">
<pre class="src src-javascript">reduce(sum, 0, reducer([1,2,3], map(inc)))
</pre>
</div>

<p>
ç­‰ç­‰,æ€ä¹ˆåšåˆ°çš„&#x2026;ä½ å·²ç»æ¶ˆè´¹äº†colläº†, é‚£reducingå‡½æ•°æ€ä¹ˆè¿›æ¥çš„, reduceræ€ä¹ˆçŸ¥é“ç”¨sumå»reduceå‘¢.
</p>
</div>


<div id="outline-container-org18e2277" class="outline-5">
<h5 id="org18e2277">Reducible</h5>
<div class="outline-text-5" id="text-org18e2277">
<p>
ç­”æ¡ˆæ˜¯, åè½¬reduceçš„å…³ç³», åŸæ¥reduceç”¨sumå»è®¡ç®—ç»“æœ, ç°åœ¨,æˆ‘ä»¬è°ƒç”¨reducibleçš„reduceæ–¹æ³•æ¥è®¡ç®—ç»“æœ
</p>


<figure>
<img src="./images/came-out.gif" alt="came-out.gif">

</figure>

<p>
å¦‚æœä½ è¿˜æ²¡æœ‰è¢«æˆ‘å¼„æ™•çš„è¯, å‡†å¤‡å¥½, åˆæ¥ä¸€ä¸ªæ–°å•è¯ <i>reducible</i>. ä¹Ÿå°±æ˜¯å¯ä»¥è¢«reduceçš„ä¸œè¥¿.
</p>

<p>
äºæ˜¯æˆ‘ä»¬éœ€è¦collå®ç°reduceæ–¹æ³•,è¿™æ ·å°±æˆä¸ºreducibleäº†.
</p>

<p>
ä¹Ÿå°±æ˜¯reduceå‡½æ•°ç°åœ¨åº”è¯¥é•¿è¿™æ ·, æˆ‘ä»¬æš‚ä¸”å«å®ƒ <code>rreduce</code>
</p>
<div class="org-src-container">
<pre class="src src-javascript"><span style="color: #00008b;">function</span> <span style="color: #6a5acd;">rreduce</span>(<span style="color: #b8860b;">reduceFn</span>, <span style="color: #b8860b;">init</span>, <span style="color: #b8860b;">reducible</span>){
  reducible(reduceFn, init)
}
</pre>
</div>
<p>
é‚£ä¹ˆæˆ‘ä»¬çš„ä¾‹å­å°±å˜æˆäº†è¿™æ ·
</p>
<div class="org-src-container">
<pre class="src src-javascript">reducer([1,2,3], map(inc))(sum, 0)
</pre>
</div>
<p>
reduceræ¥æ”¶collå’Œxf, è¿”å›reducibleå‡½æ•°. è¿™ä¸€åˆ‡éƒ½æ˜¯lazyçš„, ç›´åˆ°rreduceè°ƒç”¨<a href="#coderef-coll" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-coll');" onmouseout="CodeHighlightOff(this, 'coderef-coll');">ç¬¬collè¡Œ</a>æ‰æ‰§è¡Œ.
</p>
<div class="org-src-container">
<pre class="src src-javascript"><span style="color: #00008b;">function</span> <span style="color: #6a5acd;">reducer</span>(<span style="color: #b8860b;">coll</span>, <span style="color: #b8860b;">xf</span>){
  <span style="color: #00008b;">return</span> <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">reduceFn</span>, <span style="color: #b8860b;">init</span>){
<span id="coderef-coll" class="coderef-off">    <span style="color: #00008b;">return</span> coll.reduce(xf(reduceFn), init) (coll)</span>
  }
}
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org362ac0c" class="outline-3">
<h3 id="org362ac0c"><span class="section-number-3">4.2</span> Transducer</h3>
<div class="outline-text-3" id="text-4-2">
<p>
è¯´äº†åŠå¤©Reducer,æ˜æ˜è¯´å¥½çš„è¦è§£é‡Šçš„Transducerå‘¢?
</p>

<p>
å¦‚æœä½ è¿˜èƒ½follow, é‚£ä¹ˆç°åœ¨è¦å¼€å§‹è§£é‡ŠTransduceräº†
</p>

<p>
å…¶å®ä½ å·²ç»è§è¿‡Transduceräº†, å†å›é¡¾ä¸€ä¸‹ä¹‹å‰è¯´çš„Reducer
</p>
<ol class="org-ol">
<li>æ¥æ”¶ä¸€ä¸ªxfå‡½æ•°å’Œä¸€ä¸ªcoll</li>
<li>ç”¨xfè½¬æ¢reducingå‡½æ•°, å¹¶åº”ç”¨åˆ°coll</li>
</ol>

<p>
Transducerå°±æ˜¯é‚£ä¸ªxf
</p>
<div class="org-src-container">
<pre class="src src-javascript">reduce(map(inc)(sum),0,[1,2,3])
</pre>
</div>
<p>
ä¹Ÿå°±æ˜¯è¿™é‡Œé¢çš„ <code>map(inc)</code>
</p>

<p>
é , å°±è¿™ä¹ˆç®€å•?
</p>

<p>
å°±æ˜¯è¿™ä¹ˆç®€å•, å‰é¢è¯´äº†reducerçš„å‡ºç°æ˜¯å› ä¸ºæƒ³ä¿æŒåŸå§‹reduceçš„apiä¸ä¾¿, é‚£ä¹ˆtranduceråˆ™æä¾›äº†
å¦å¤–ä¸€ç§reduce api
</p>

<div class="org-src-container">
<pre class="src src-javascript">transduce(map(inc), sum, 0, [1,2,3])
</pre>
</div>
<p>
transduceæ¥æ”¶ä¸€ä¸ªtransducer,ä¸€ä¸ªreducing function, ä¸€ä¸ªåˆå§‹å€¼, ä¸€ä¸ªcoll. è¿™æ®µä»£ç è·Ÿå‰é¢å¹²çš„äº‹æƒ…ä¸€æ¨¡ä¸€æ ·.
</p>

<p>
å¦å¤–ç‰›é€¼çš„æ˜¯transducerè·Ÿcontextå®Œå…¨æ²¡æœ‰å…³ç³», å°±æ˜¯å®Œå…¨ä¸æ•°æ®è§£è€¦å¼€æ¥, æ¯”å¦‚æˆ‘ä»¬ç»„è£…å¥½ä¸€ä¸ªtransducer xf
</p>

<p>
å¯ä»¥ç”¨åœ¨ä»»ä½•åœ°æ–¹
</p>
<div class="org-src-container">
<pre class="src src-javascript">seq(xf data) <span style="color: #8c8c8c; font-style: italic;">//</span><span style="color: #8c8c8c; font-style: italic;">&#29983;&#25104;&#19968;&#20010;lazy&#30340;&#24207;&#21015;, &#21516;&#26102;lazy transform, &#27599;&#27425;&#21462;&#30340;&#26102;&#20505;data&#20250;&#34987;transform</span>
into([], xf data) <span style="color: #8c8c8c; font-style: italic;">//</span><span style="color: #8c8c8c; font-style: italic;">&#25226; data transform&#21518;&#25918;&#21040;&#19968;&#20010;&#25968;&#32452;&#37324;</span>
chan(1, xform) <span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">&#24403;&#25968;&#25454;&#32463;&#36807;CSP&#30340;channel&#26102;&#34987;transform</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org9b5d2eb" class="outline-3">
<h3 id="org9b5d2eb"><span class="section-number-3">4.3</span> Is it Curry?</h3>
<div class="outline-text-3" id="text-4-3">
<p>
æ€ä¹ˆçœ‹ç€æœ‰ç‚¹åƒæŸ¯é‡ŒåŒ–, ä¸€æ ·ä¹ˆ?
</p>

<p>
å½“ç„¶ä¸æ˜¯, æŸ¯é‡ŒåŒ–æˆ–è€…éƒ¨åˆ†å‚æ•°åªæ˜¯éƒ¨åˆ†é…ç½®å‚æ•°, è€Œtransduceræ˜¯ä¸€æ¬¡å¤šnæ¬¡è½¬æ¢çš„ç»„åˆ
</p>

<p>
æ¯”å¦‚ä¸€ä¸ªæŸ¯é‡ŒåŒ–çš„mapå¯ä»¥
</p>
<div class="org-src-container">
<pre class="src src-javascript"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">mapinc</span> = map(inc)
mapinc([1,2,3])
</pre>
</div>

<p>
è€Œä¸èƒ½
</p>
<div class="org-src-container">
<pre class="src src-javascript">mapinc(sum)
</pre>
</div>
<p>
å› ä¸ºmapå°±ä¿©å‚æ•°, ç¬¬ä¸€ä¸ªæ˜¯å‡½æ•°ç¬¬äºŒä¸ªæ˜¯data, å¦‚æœå†ç»™dataä¼šé”™è¯¯
</p>

<p>
ä½†æ˜¯tranceduceråªæ˜¯è½¬æ¢, æ‰€ä»¥åªæ¥å—reducingå‡½æ•°
</p>
<div class="org-src-container">
<pre class="src src-javascript">reduce(mapinc(sum), 0, [1,2,3])
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; 9</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1fb9d37" class="outline-3">
<h3 id="org1fb9d37"><span class="section-number-3">4.4</span> å®Œæ•´ä¾‹å­</h3>
<div class="outline-text-3" id="text-4-4">
<a class="jsbin-embed" href="https://jsbin.com/sulaxe/1/embed?html,js,console">JS Bin</a><script src="https://static.jsbin.com/js/embed.js"></script>
</div>
</div>
</div>

<div id="outline-container-orgf3599f7" class="outline-2">
<h2 id="orgf3599f7"><span class="section-number-2">5</span> Functor</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org9041e26" class="outline-3">
<h3 id="org9041e26"><span class="section-number-3">5.1</span> Functor</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Functor æ˜¯ å¯ä»¥è¢« map over çš„ç±»å‹. ä»€ä¹ˆå« map over&#x2026;
</p>

<p>
æ¯”å¦‚ list å°±å¯ä»¥è¯´æ˜¯å¯ä»¥è¢«map over&#x2026; é‚£ä¹ˆæ˜¯ä¸æ˜¯å¯æšä¸¾ç±»å‹?
</p>

<p>
ä¸æ˜¯çš„, æ¥çœ‹çœ‹ Haskell ä¸­å¦‚ä½•è§£é‡Š(å…¶å®æ‰€æœ‰å‡½æ•°å¼çš„æ¦‚å¿µå¯èƒ½ç”¨ haskell
æ˜¯æœ€èƒ½è¯´æ˜é—®é¢˜çš„äº†).
</p>

<div class="org-src-container">
<pre class="src src-haskell">ghci <span style="color: #6a5acd;">&gt;</span> <span style="color: #36648b;">:</span>t fmap
<span style="color: #6a5acd;">fmap</span> <span style="color: #b8860b;">::</span> (a <span style="color: #b8860b;">-&gt;</span> b) <span style="color: #b8860b;">-&gt;</span> fa <span style="color: #b8860b;">-&gt;</span> f b
</pre>
</div>

<p>
<code>fmap</code> åˆæ˜¯ä»€ä¹ˆä¸œè¥¿, fmap æ˜¯ map over Functor çš„å‡½æ•°.
è¿™ä¸ªå‡½æ•°åªå¹²ä¸€ä¸ªäº‹æƒ…, å¯èƒ½é€šè¿‡å‰é¢è§£é‡Šçš„ä¸€ç‚¹ç‚¹
HaskellåŠŸå¤«,ä½ å¯èƒ½èƒ½ç¿»è¯‘ <code>(a -&gt; b) -&gt; fa -&gt; f b</code> äº†æŠŠ. ç»™å®šä¸€ä¸ªä» <code>a</code> åˆ° <code>b</code>
çš„æ˜ å°„å‡½æ•°, å†ç»™å®šä¸€ä¸ª a çš„ Functor, è¿”å›ä¸€ä¸ª b çš„ Functor.
</p>

<p>
è™½ç„¶ä¸ªä¸ªå­—éƒ½è®¤è¯†, ä½†æ€ä¹ˆå°±ä¸çŸ¥é“å•¥æ„æ€.
</p>

<p>
å¦‚æœæˆ‘å†è¯´ä¸€ä¸ªæ–°è¯, ä½ æ˜¯ä¸æ˜¯ä¼šç–¯æ‰äº†&#x2013; Lift.
</p>

<p>
å¥½å§, æŠŠä»–ä»¬éƒ½ä¸²èµ·æ¥, ä½ å°±æ˜ç™½äº†. 
</p>
<ol class="org-ol">
<li>å¹³å¸¸æˆ‘ä»¬å¯ä»¥æŠŠ <code>a</code> åˆ° <code>b</code> çš„æ˜ å°„å¯ä»¥å«åš map, æ˜ å°„çš„æ–¹å¼å°±æ˜¯å‡½æ•°äº†.</li>
<li>é‚£ä¹ˆç±»ä¼¼çš„å¯¹äºå‡½æ•°æˆ–è€…å…¶ä»–å¯ä»¥åšè¿™ç§ map æ“ä½œçš„ç±»å‹æˆ–ä¸€ç§è®¡ç®—æ–¹å¼, å«åš Functor.</li>
<li>è€Œè¿™ç§ map å°±å«åš fmap, ç»™å®š a é›†åˆåˆ° b é›†åˆçš„æ˜ å°„æ–¹å¼(ä¹Ÿå°±æ˜¯ä¸€ä¸ªå‡½æ•°), å°±èƒ½æ‰¾åˆ° å¯¹ a çš„ä¸€ç§è®¡ç®—(computation, ä»»ä½•å¯å˜æ¢çš„ç±»å‹, è¿™å°±æ˜¯ Functor) çš„å˜æ¢ &#x2013; å¯¹ b çš„å¯¹åº”è®¡ç®—æ–¹å¼.</li>
<li>å¦‚æœè¯¥è®¡ç®—æ˜¯ä¸€ä¸ªå‡½æ•°, é‚£ä¹ˆè¿™ä¸ªæ“ä½œå«åš lifting. éå¸¸å½¢è±¡çš„, æ ¹æ® a åˆ° b çš„æ˜ å°„ lift(ä¸¾) åˆ°å¦ä¸€ä¸ªå±‚é¢ä¸Š.</li>
</ol>


<figure>
<img src="https://learnyouahaskell-zh-tw.csie.org/img/lifter.png" alt="lifter.png">

</figure>

<p>
è™½ç„¶ lifting å¾ˆå½¢è±¡, ä½†æ˜¯è¿˜æ˜¯è¶Šè¯´è¶ŠæŠ½è±¡äº†, æ¥ä¸¾ä¸ªæ —å­. 
</p>
</div>
</div>
<div id="outline-container-org275921a" class="outline-3">
<h3 id="org275921a"><span class="section-number-3">5.2</span> ä¸¾ä¸ªæ —å­ğŸŒ°</h3>
<div class="outline-text-3" id="text-5-2">
<div class="epigraph"><blockquote>
<p>
æ³¨æ„æˆ‘ä»¬è¿˜æ²¡æœ‰å®ç° Functor, å› æ­¤ä¸‹é¢çš„æ —å­è¿˜ä¸èƒ½è¿è¡Œåœ¨ä½ çš„
console.
</p>

</blockquote></div>

<p>
å‰é¢è¯´äº†, Functor å¯ä»¥æ˜¯æ•°ç»„, å› ä¸ºæ•°ç»„å¯ä»¥è¢« map over
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">plus1</span> = n =&gt; n+1;
fmap(plus1, [2, 4, 6, 8])<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; [3,5,7,9]</span>
</pre>
</div>

<p>
è¿™é‡Œ,æ•°ç»„ Array å°±æ˜¯ Functor ç±»å‹, è€Œ fmap æŠŠ 2 -&gt; 3 çš„æ˜ å°„æ–¹å¼å¯¹ Array
[2,4,6,8] è¿›è¡Œäº†å˜æ¢, å¾—åˆ° [3,5,7,9]. è¿™è·Ÿæ•°ç»„çš„ map æ–¹æ³•ä¸€æ ·,
æ¯”è¾ƒå¥½ç†è§£.
</p>

<p>
å†è¯•è¯•æ¢ä¸€ç§ Functor ç±»å‹, è¯•è¯•å‡½æ•°
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">times2</span> = m =&gt; m*2;
fmap(plus1, times2) <span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; function(){}</span>
fmap(plus1, times2)(3) <span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; 7 (3*2+1)</span>
</pre>
</div>

<p>
çœ‹åˆ° fmap è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°, å› ä¸ºä½  map over çš„æ˜¯ä¸€ä¸ªå‡½æ•° <code>times2</code>. è¿˜è®°å¾—
<code>(a -&gt; b) -&gt; f a -&gt; f b</code> çš„å…¬å¼ä¹ˆ, å› ä¸ºç°åœ¨çš„ Functor ä¸º Function ç±»å‹,
æˆ‘ä»¬å¯ä»¥æŠŠ=f=æ›¿æ¢æˆå‡½æ•°ä¹Ÿå°±æ˜¯ x åˆ° y çš„æ˜ å°„, å› æ­¤æˆ‘ä»¬å¯ä»¥å°†è¯¥å…¬å¼æ›¿æ¢ä¸º
</p>

<pre class="example">
(a -&gt; b) -&gt; (x -&gt; a) -&gt; (x -&gt; b)
</pre>

<p>
å†ç”¨æˆ‘ä»¬å…·ä½“çš„å‡½æ•° plus1 æ›¿æ¢è¿›å»
</p>

<pre class="example">
(n-&gt;n*2) -&gt; plus1(n) -&gt; plus1(n*2)
</pre>

<p>
ä¹Ÿå°±æ˜¯è¯´, è¿™ä¸ª fmap ä¼šæŠŠå‡½æ•° times2 åº”ç”¨åˆ° plus1 çš„ä»»ä½•ç»“æœä¸Š.
</p>

<p>
è¿™ä¸å°±æ˜¯å‡½æ•°ç»„åˆå— <code>plus1(times2(3))</code>, ç¡®å®æ˜¯çš„. ä½†è¿™åªæ˜¯ Functor
çš„å†°å±±ä¸€è§’, danåœ¨æ¥çœ‹çœ‹åˆ«çš„Functor
</p>

<p>
Functor è¿˜å¯ä»¥æ˜¯åˆ«çš„ä¸œè¥¿&#x2026;æ¯”å¦‚
</p>

<pre class="example">
fmap(plus1, Either(10, 20))
</pre>

<p>
Eitherä¹Ÿæ˜¯ Functor, æ…¢ç€, Either æ˜¯ä»€ä¹ˆç±»å‹, å¥½å§,åœ¨è§£é‡Š Either ä¹‹å‰,
æˆ‘ä»¬å…ˆå¿ä¸€å¿, æ¥å…ˆçœ‹çœ‹ JavaScript ä¸­æ€ä¹ˆå®ç°ä»¥åŠä½¿ç”¨ä¸€ä¸ª Functor.
</p>
</div>
</div>

<div id="outline-container-org6ab7600" class="outline-3">
<h3 id="org6ab7600"><span class="section-number-3">5.3</span> Functor in JavaScript</h3>
<div class="outline-text-3" id="text-5-3">
<p>
é¦–å…ˆ, æˆ‘ä»¬ç”¨å®šä¹‰ä¸€ä¸ªç¡®å®š Functor ç±»å‹çš„å‡½æ•°, å¦‚æœæ²¡æœ‰æ³¨å†Œçš„ç±»å‹æŠ›å‡ºå¼‚å¸¸.
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">types</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">obj</span>) {
  <span style="color: #00008b;">throw</span> <span style="color: #00008b;">new</span> <span style="color: #36648b;">TypeError</span>(<span style="color: #8b0000;">"fmap called on unregistered type: "</span> + obj);
};
</pre>
</div>

<p>
ç„¶åå®ç°æ³¨å†Œ Functor çš„å‡½æ•°.
</p>

<div class="org-src-container">
<pre class="src src-js"> Functor = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">type</span>, <span style="color: #b8860b;">defs</span>) {
        <span style="color: #00008b;">var</span> <span style="color: #b8860b;">oldTypes</span> = types;
        types = (obj) =&gt; {
            <span style="color: #00008b;">if</span> (type.<span style="color: #6b8e23;">prototype</span>.isPrototypeOf(obj)) {
                <span style="color: #00008b;">return</span> defs; <span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">&#36825;&#26159;&#36882;&#24402;&#30340;&#20986;&#21475;, &#21028;&#26029;&#31867;&#22411;, &#30830;&#23450; fmap &#30340; Functor &#23454;&#20363;&#23646;&#20110;&#27880;&#20876;&#30340;&#21738;&#19968;&#20010; Functor</span>
            }
            <span style="color: #00008b;">return</span> oldTypes(obj); <span style="color: #8c8c8c; font-style: italic;">//</span><span style="color: #8c8c8c; font-style: italic;">&#19981;&#26029;&#36882;&#24402;&#23547;&#25214; types, &#36825;&#20010;&#25928;&#29575;&#20250;&#24456;&#20302;, &#22240;&#20026;&#35843;&#29992;&#26632;&#19978;&#22909;&#22810;&#38381;&#21253;, &#27599;&#20010;&#38381;&#21253;&#37117;&#20445;&#25345;&#30528; type &#21644; defs</span>
        }
};
</pre>
</div>

<p>
è¿™æ ·å¯ä»¥ç”¨ Functor å‡½æ•°æ³¨å†Œä¸€ä¸ªæ–°çš„ Functor ç±»å‹å¹¶å®šä¹‰å®ƒè‡ªå·±çš„ fmap
æ–¹æ³•(è¿˜è®°å¾—å‰é¢è¯´çš„ Functor åªæœ‰ä¸€ä¸ªæ–¹æ³•å—). æ¯”å¦‚æˆ‘ä»¬è¦æŠŠ Array å˜æˆ
Functor
</p>

<div class="org-src-container">
<pre class="src src-js">Functor(Array, {
    fmap: (fn, array) =&gt; {
        arr.map(x =&gt; fn(x))
    }
})
</pre>
</div>

<p>
å¥½åƒå¿«è¦å®Œæˆçš„æ ·å­. ç°åœ¨è¿˜å·® fmap Functor ç±»å‹å‡½æ•°äº†.
è¿™ä¸ªå‡½æ•°å¹²ä¸¤ä»¶äº‹æƒ…, æ‰¾åˆ°å®ä¾‹å±äºå“ªä¸ª Functor ç±»å‹, å¹¶è°ƒç”¨ä»–çš„ fmap æ–¹æ³•.
</p>

<div class="org-src-container">
<pre class="src src-js">fmap = eweda.curry((fn, obj) =&gt; {
    <span style="color: #00008b;">return</span> types(obj).fmap(f, obj)
})
</pre>
</div>

<p>
åŒæ ·çš„, æˆ‘ä»¬å¾ˆå¿«å¯ä»¥æŠŠ Function ä¹Ÿå˜æˆ Functor
</p>

<div class="org-src-container">
<pre class="src src-js">Functor(Function, {
    fmap: (f, g) =&gt; {
        <span style="color: #00008b;">return</span> eweda.compose(f, g);
}})
</pre>
</div>

<p>
è¿˜è®°å¾—å‰é¢è¯´ fmap å‡½æ•°åƒå‡½æ•°ç»„åˆå—, å‘µå‘µ, æˆ‘ä»¬è¿™é‡Œå°±æŒ‰å‡½æ•°ç»„åˆå®ç°.
</p>

<hr>

<p>
æ¥æ€»ç»“ä¸€ä¸‹ fmap å’Œ Functor åˆ°åº•æ˜¯ä»€ä¹ˆ, fmap å¯ä»¥å°†å‡½æ•°åº”ç”¨åˆ° Functor ä¸Š,
Functor å¯ä»¥çœ‹åšæ˜¯å®¹å™¨æˆ–è€…æ˜¯å¸¦ context çš„å€¼. ä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬æƒ³å˜æ¢ x
çš„å€¼, ç›´æ¥ç»™ä¸€ä¸ªå‡½æ•°æ˜ å°„ <code>x=&gt; x*2</code> å³å¯. å¦‚æœæˆ‘æƒ³å˜æ¢ä¸€ä¸ªæ•°ç»„, ä¸€ä¸ªå‡½æ•°,
æˆ–è€… Either è¿™ç§å¸¦æœ‰ context çš„æˆ–è€…è¯´å®¹å™¨é‡Œé¢çš„å€¼,
æ€»ä¸èƒ½ç›´æ¥æŠŠè¿™äº›å®¹å™¨ç›´æ¥ç»™å‡½æ•°å§ï¼Œè¿™æ—¶å°±éœ€è¦ fmap
å°†å‡½æ•°çš„æ˜ å°„å…³ç³»åº”ç”¨åˆ°å®¹å™¨é‡Œé¢çš„å€¼.
å…¶å®å°±æ˜¯æ‰“å¼€ï¼Œè°ƒä¸€ä¸‹å‡½æ•°ï¼Œå®Œäº†å†åŒ…å¥½ã€‚
</p>

<p>
å¥½å§, é€šè¿‡å¦‚ä½•å®ç°å’Œä½¿ç”¨ä¸€ä¸ªç®€å•çš„ Functor, æ¦‚å¿µä¸Šå·²ç»ä¼°è®¡å¯ä»¥ç†è§£äº†,
æˆ‘ä»¬å›è¿‡å¤´æ¥çœ‹çœ‹ Either æ˜¯ç¥é©¬ç©æ„.
</p>

<p>
<a href="https://jsbin.com/xezun/1/embed?js,console">å®Œæ•´ä»£ç </a>
</p>
</div>
</div>
</div>
<div id="outline-container-org4f73a27" class="outline-2">
<h2 id="org4f73a27"><span class="section-number-2">6</span> Monad</h2>
<div class="outline-text-2" id="text-6">
<p>
è¿™ä¸ªæ¦‚å¿µå¥½éš¾è§£é‡Š, ä½ å¯ä»¥ç†è§£ä¸ºä¸€ä¸ª Lazy æˆ–è€…æ˜¯çŠ¶æ€æœªçŸ¥çš„ç›’å­.
å¬èµ·æ¥åƒæ˜¯<a href="https://zh.wikipedia.org/wiki/%E8%96%9B%E5%AE%9A%E8%B0%94%E7%8C%AB">è–›å®šè°”çŒ«</a>(ä¼°è®¡ç‚¹è¿›å»ä½ ä¼šæ›´æ™•äº†).
å…¶å®å°±æ˜¯çš„, åœ¨ä½ æ‰“å¼€è¿™ä¸ªç›’å­ä¹‹å‰, ä½ æ˜¯ä¸çŸ¥é“é‡Œé¢çš„çŒ«å¤„åœ¨é‚£ç§çŠ¶æ€.
</p>

<p>
Monad è¿™ä¸ªé»‘ç›’å­, é‡Œé¢åˆ°åº•å–çš„ç¥é©¬è¯,æˆ‘ä»¬è¦æ‰“å¼€å–äº†æ‰çŸ¥é“.
</p>

<p>
ç­‰ç­‰, ä¸æ˜¯è¯´å¥½è¦è§£é‡Š Either çš„å—, å—¯å—¯, è¿™é‡Œå°±æ˜¯åœ¨è§£é‡Š Either. ä¸ŠèŠ‚è¯´
Either æ˜¯ä¸€ä¸ª Functor, å¯ä»¥è¢« fmap over. æ€ä¹ˆè¿™é‡Œåˆè¯´é“é»‘ç›’å­äº†? å¥½å§,
Monad å…¶å®ä¹Ÿæ˜¯ Functor. è¿˜è®°å¾—æˆ‘è¯´çš„ Functor å…¶å®æ˜¯ä¸€ä¸ªå¸¦ context
çš„ç›’å­å—. è€Œ fmap ä½¿å¾—å¾€ç›’å­é‡Œåº”ç”¨å‡½æ•°å˜æ¢æˆä¸ºäº†å¯èƒ½.
</p>
</div>

<div id="outline-container-org8dec7d7" class="outline-3">
<h3 id="org8dec7d7"><span class="section-number-3">6.1</span> Either</h3>
<div class="outline-text-3" id="text-6-1">
<p>
å…ˆæ¥çœ‹çœ‹ Either è¿™ç§ç±»å‹ä¼šå¹²ä»€ä¹ˆäº‹æƒ….
<a href="https://hackage.haskell.org/package/base-4.7.0.0/docs/Data-Either.html#t:Either">Either</a>è¡¨ç¤ºè¦ä¸æ˜¯å·¦è¾¹å°±æ˜¯å³è¾¹çš„å€¼,
å› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥è¡¨ç¤ºè–›å®šè°”çŒ«, è¦ä¸æ˜¯æ´»ç€, è¦ä¸æ­»äº†. Either è¿˜æœ‰ä¸ªæ–¹æ³•:
either
</p>

<pre class="example">
(a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</pre>

<p>
æƒ³å¿…ä½ å·²ç»å¯¹ç®­å¤´ <code>-&gt;</code> éå¸¸ç†Ÿäº†å§.å¦‚æœå‰é¢å‡ ç« ä½ éƒ½è·³è¿‡äº†,æˆ‘å†ç¿»è¯‘ä¸‹å¥½äº†.
è¿™é‡Œè¡¨ç¤ºæ¥æ”¶å‡½æ•° <code>a-&gt;c</code> å’Œå‡½æ•° <code>b-&gt;c</code>, å†æ¥æ”¶ä¸€ä¸ª Either, å¦‚æœ Either
çš„å€¼åœ¨å·¦è¾¹,åˆ™ä½¿ç”¨å‡½æ•°æ˜ å°„ <code>a-&gt;c</code>, è‹¥å€¼åœ¨å³è¾¹,åˆ™åº”ç”¨ç¬¬äºŒä¸ªå‡½æ•°æ˜ å°„ <code>b-&gt;c</code>.
</p>

<p>
ä½œä¸º Monad, å®ƒè¿˜å¿…é¡»å…·å¤‡ä¸€ä¸ªæ–¹æ³• '&gt;&gt;='(è¿™ä¸ªç¬¦å·å¥½çœ¼ç†Ÿçš„è¯´, çœ‹çœ‹ haskell
çš„ logo, ä½ å°±çŸ¥é“ Monad æ˜¯æœ‰å¤šé‡è¦), ä¹Ÿå°±æ˜¯ bind æ–¹æ³•.
</p>


<figure>
<img src="https://www.haskell.org/wikistatic/haskellwiki_logo.png" alt="haskellwiki_logo.png">

</figure>

<p>
bind æ–¹æ³•çš„æ„æ€å¾ˆç®€å•, å°±æ˜¯ç»™è¿™ä¸ªç›’å­åŠ ä¸€ä¸ªæ“ä½œ,
æ¯”å¦‚å¾€ç›’å­åœ¨åŠ æ”¾å°„æ€§åŸå­,å¦‚æœçŒ«æ´»ç€,å°±æ˜¯ç»¿å·¨çŒ«,
å¦‚æœçŒ«æ˜¯æ­»çš„,é‚£å°±æ˜¯ç»¿å·¨æ­»çŒ«.
</p>

<div class="org-src-container">
<pre class="src src-js">Left(<span style="color: #8b0000;">"cat"</span>).bind(cat =&gt; Right(<span style="color: #8b0000;">'hulk'</span>+cat))
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; Left "hulkcat"</span>
Right(<span style="color: #8b0000;">"deadcat"</span>).bind(cat =&gt; Left(<span style="color: #8b0000;">'hulk'</span> + cat))
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; Right "hulkdeadcat"</span>
</pre>
</div>

<p>
è¿™æœ‰ä¸ªæ¯›ç”¨å•Š. è¡¨æ€¥&#x2026; æ¥çœ‹ä¸ªç»å…¸ä¾‹å­ 
</p>
</div>
</div>

<div id="outline-container-orgffb6c2b" class="outline-3">
<h3 id="orgffb6c2b"><span class="section-number-3">6.2</span> èµ°é’¢ç´¢</h3>
<div class="outline-text-3" id="text-6-2">
<p>
çš®å°”æ–¯å†³å®šè¦è¾æ‰ä»–çš„å·¥ä½œæ”¹è¡Œè¯•ç€èµ°é’¢ç´¢ã€‚ä»–å¯¹èµ°é’¢ç´¢è›®åœ¨è¡Œçš„ï¼Œä¸è¿‡ä»æœ‰ä¸ªå°é—®é¢˜ã€‚å°±æ˜¯é¸Ÿä¼šåœåœ¨ä»–æ‹¿çš„å¹³è¡¡ç«¿ä¸Šã€‚ä»–ä»¬ä¼šé£è¿‡æ¥åœä¸€å°ä¼šå„¿ï¼Œç„¶åå†é£èµ°ã€‚è¿™æ ·çš„æƒ…å†µåœ¨ä¸¤è¾¹çš„é¸Ÿçš„æ•°é‡ä¸€æ ·æ—¶å¹¶ä¸æ˜¯ä¸ªå¤ªå¤§çš„é—®é¢˜ã€‚ä½†æœ‰æ—¶å€™ï¼Œæ‰€æœ‰çš„é¸Ÿéƒ½ä¼šæƒ³è¦åœåœ¨åŒä¸€è¾¹ï¼Œçš®å°”æ–¯å°±å¤±å»äº†å¹³è¡¡ï¼Œå°±ä¼šè®©ä»–ä»é’¢ç´¢ä¸Šæ‰ä¸‹å»ã€‚
</p>


<figure>
<img src="https://learnyouahaskell-zh-tw.csie.org/img/pierre.png" alt="pierre.png">

</figure>

<p>
æˆ‘ä»¬è¿™è¾¹å‡è®¾ä¸¤è¾¹çš„é¸Ÿå·®å¼‚åœ¨ä¸‰ä¸ªä¹‹å†…çš„æ—¶å€™ï¼Œçš®å°”æ–¯ä»èƒ½ä¿æŒå¹³è¡¡ã€‚
</p>
</div>

<div id="outline-container-org1728e35" class="outline-4">
<h4 id="org1728e35"><span class="section-number-4">6.2.1</span> ä¸€èˆ¬è§£æ³•</h4>
<div class="outline-text-4" id="text-6-2-1">
<p>
é¦–å…ˆçœ‹çœ‹ä¸ç”¨ Monad æ€ä¹ˆè§£
</p>

<div class="org-src-container">
<pre class="src src-js">eweda.installTo(<span style="color: #6b8e23;">this</span>);
<span style="color: #00008b;">var</span> <span style="color: #b8860b;">landLeft</span> = eweda.curry(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">n</span>, <span style="color: #b8860b;">pole</span>){
    <span style="color: #00008b;">return</span> [pole[0]+n, pole[1]];
});
<span style="color: #00008b;">var</span> <span style="color: #b8860b;">landRight</span> = eweda.curry(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">n</span>, <span style="color: #b8860b;">pole</span>){
    <span style="color: #00008b;">return</span> eweda.reverse(landLeft(n, eweda.reverse(pole)));
});
<span style="color: #00008b;">var</span> <span style="color: #b8860b;">result</span> = eweda.pipe(landLeft(1), landRight(1), landLeft(2))([0,0]);
console.log(result);
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; [3, 1]</span>
</pre>
</div>

<p>
è¿˜å·®ä¸€ä¸ªåˆ¤æ–­çš®å°”æ–¯æ˜¯å¦æ‰ä¸‹æ¥çš„æ“ä½œ.
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">landLeft</span> = eweda.curry(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">n</span>, <span style="color: #b8860b;">pole</span>){
    <span style="color: #00008b;">if</span>(pole===<span style="color: #8b0000;">'dead'</span>) <span style="color: #00008b;">return</span> pole;
    <span style="color: #00008b;">if</span>(Math.abs(pole[0]-pole[1]) &gt; 3)
      <span style="color: #00008b;">return</span> <span style="color: #8b0000;">'dead'</span>;
    <span style="color: #00008b;">return</span> [pole[0]+n, pole[1]];
});
<span style="color: #00008b;">var</span> <span style="color: #b8860b;">landRight</span> = eweda.curry(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">n</span>, <span style="color: #b8860b;">pole</span>){
    <span style="color: #00008b;">if</span>(pole===<span style="color: #8b0000;">'dead'</span>) <span style="color: #00008b;">return</span> pole;
    <span style="color: #00008b;">return</span> eweda.reverse(landLeft(n, eweda.reverse(pole)));
});
<span style="color: #00008b;">var</span> <span style="color: #b8860b;">result</span> = eweda.pipe(landLeft(10), landRight(1), landRight(8))([0,0]);
console.log(result);
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; dead</span>
</pre>
</div>

<p>
<a href="https://jsbin.com/pozim/8/watch?js,console,output">å®Œæ•´ä»£ç </a>
</p>

<hr>
</div>
</div>

<div id="outline-container-org074fc4b" class="outline-4">
<h4 id="org074fc4b"><span class="section-number-4">6.2.2</span> ç°åœ¨æ¥è¯•è¯•ç”¨ Either</h4>
<div class="outline-text-4" id="text-6-2-2">
<p>
æˆ‘ä»¬å…ˆæŠŠçš®å°”æ–¯æ”¾è¿› Either ç›’å­é‡Œ, è¿™æ ·çš®å°”æ–¯çš„çŠ¶æ€åªæœ‰æ‰“å¼€ Either
æ‰èƒ½çœ‹è§. å‡è®¾ Either Right æ˜¯æ´»ç€, Left çš„è¯çš®å°”æ–¯æŒ‚äº†.
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">land</span> = eweda.curry(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">lr</span>, <span style="color: #b8860b;">n</span>, <span style="color: #b8860b;">pole</span>){
    pole[lr] = pole[lr] + n;
    <span style="color: #00008b;">if</span>(Math.abs(pole[0]-pole[1]) &gt; 3) {
      <span style="color: #00008b;">return</span> <span style="color: #00008b;">new</span> <span style="color: #36648b;">Left</span>(<span style="color: #8b0000;">"dead when land "</span> + n + <span style="color: #8b0000;">" became "</span> + pole);
    }
    <span style="color: #00008b;">return</span> <span style="color: #00008b;">new</span> <span style="color: #36648b;">Right</span>(pole);
});

<span style="color: #00008b;">var</span> <span style="color: #b8860b;">landLeft</span> = land(0)
<span style="color: #00008b;">var</span> <span style="color: #b8860b;">landRight</span> = land(1);
</pre>
</div>

<p>
ç°åœ¨è½é¸Ÿåä¼šè¿”å›ä¸€ä¸ª Either, è¦ä¸æ´»ç€, è¦ä¸æŒ‚äº†.
æ‰“å¼€ç›’å­çš„å‡½æ•°å¯ä»¥æ˜¯è¿™æ ·çš„
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">stillAlive</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">x</span>){
    console.log(x)
}
<span style="color: #00008b;">var</span> <span style="color: #b8860b;">dead</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">x</span>){
    console.log(<span style="color: #8b0000;">'&#30382;&#23572;&#26031;'</span> + x);
}
either(dead, stillAlive, landLeft(2, [0,0]))
</pre>
</div>

<p>
å¥½å§, å¥½åƒæœ‰ä¸€ç‚¹ç‚¹åƒäº†, ä½†æ˜¯è¿™åªè½äº†ä¸€æ¬¡é¸Ÿ, å¦‚æœæˆ‘è¦è½å¥½å‡ æ¬¡å‘¢.
è¿™å°±éœ€è¦å®ç° Either çš„ &gt;&gt;= bind æ–¹æ³•äº†, å¦‚æœä½ è¿˜è®°å¾—å‰é¢å®ç°çš„ Functor,
è¿™é‡Œéå¸¸åƒ :
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">Monad</span> = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">type</span>, <span style="color: #b8860b;">defs</span>) {
  <span style="color: #00008b;">for</span> (name <span style="color: #00008b;">in</span> defs){
    type.<span style="color: #6b8e23;">prototype</span>[name] = defs[name];
  }
  <span style="color: #00008b;">return</span> type;
};
<span style="color: #00008b;">function</span> <span style="color: #6a5acd;">Left</span>(<span style="color: #b8860b;">value</span>){
  <span style="color: #6b8e23;">this</span>.value = value
}
<span style="color: #00008b;">function</span> <span style="color: #6a5acd;">Right</span>(<span style="color: #b8860b;">value</span>){
  <span style="color: #6b8e23;">this</span>.value=value;
}

Monad(Right, {
  <span style="color: #6a5acd;">bind</span>:<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">fn</span>){
    <span style="color: #00008b;">return</span> fn(<span style="color: #6b8e23;">this</span>.value)
  }
})

Monad(Left, {
  <span style="color: #6a5acd;">bind</span>: <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">fn</span>){
    <span style="color: #00008b;">return</span> <span style="color: #6b8e23;">this</span>;
  }
})
</pre>
</div>

<p>
å“¦, å¯¹äº†, either:
</p>

<div class="org-src-container">
<pre class="src src-js">either = <span style="color: #00008b;">function</span>(<span style="color: #b8860b;">left</span>, <span style="color: #b8860b;">right</span>, <span style="color: #b8860b;">either</span>){
    <span style="color: #00008b;">if</span>(either.constructor.name === <span style="color: #8b0000;">'Right'</span>)
        <span style="color: #00008b;">return</span> right(either.value)
    <span style="color: #00008b;">else</span>
        <span style="color: #00008b;">return</span> left(either.value)
}
</pre>
</div>

<p>
æˆ‘ä»¬æ¥è¯•è¯•å·¥ä½œä¸å·¥ä½œ.
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">walkInLine</span> = <span style="color: #00008b;">new</span> <span style="color: #36648b;">Right</span>([0,0]);
eitherDeadOrNot = walkInLine.bind(landLeft(2))
    .bind(landRight(5))
either(dead, stillAlive, eitherDeadOrNot)
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; [2,5]</span>
eitherDeadOrNot = walkInLine.bind(landLeft(2))
  .bind(landRight(5))
  .bind(landLeft(3))
  .bind(landLeft(10)
  .bind(landRight(10)))

either(dead, stillAlive, eitherDeadOrNot)
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; "&#30382;&#23572;&#26031;dead when land 10 became 15,5"</span>
</pre>
</div>

<p>
<a href="https://jsbin.com/giyig/3/watch">å®Œæ•´ä»£ç </a>
</p>
</div>
</div>
</div>

<div id="outline-container-org27af63c" class="outline-3">
<h3 id="org27af63c"><span class="section-number-3">6.3</span> åˆ°åº•æœ‰ä»€ä¹ˆç”¨å‘¢, Monad</h3>
<div class="outline-text-3" id="text-6-3">
<p>
æˆ‘ä»¬æ¥æ€»ç»“ä¸‹ä¸¤ç§åšæ³•æœ‰ä»€ä¹ˆåŒºåˆ«:
</p>

<ol class="org-ol">
<li>ä¸€èˆ¬åšæ³•æ¯æ¬¡éƒ½ä¼šæ£€æŸ¥æŸ¥å°”æ–¯æŒ‚äº†æ²¡æŒ‚, ä¹Ÿå°±æ˜¯é‡å¤è·å¾—ä¹‹å‰æ“ä½œçš„ context</li>
<li>Monad ä¸å¯¹å¼‚å¸¸åšå¤„ç†, åªæ˜¯ä¸åœåœ°å¾€ç›’å­é‡ŒåŠ æ“ä½œ. ä½ å¯ä»¥çœ‹åˆ°å¯¹é”™è¯¯çš„å¤„ç†æ¨åˆ°äº†æœ€åå–å€¼çš„ either.</li>
<li>Monad äº’ç›¸ä¼ é€’çš„åªæ˜¯ç›’å­, è€Œä¸€èˆ¬å†™æ³•ä¼šæŠŠå¼‚å¸¸å¾€ä¸‹ä¼ å¦‚ <code>dead</code>, è¿™æ ·å¯¼è‡´åé¢çš„æ“ä½œéƒ½å¾—å…ˆåˆ¤æ–­è¿™ä¸ªå¼‚å¸¸.</li>
</ol>

<div class="epigraph"><blockquote>
<p>
ç”±äºæ˜¯ç”¨ JavaScript, pole ä¸é™å®šç±»å‹,
æ‰€ä»¥è¿™é‡Œå•çº¯çš„ç”¨å­—ç¬¦ä¸²ä»£è¡¨ pole çš„å¼‚å¸¸çŠ¶æ€. ä½†å¦‚æœæ¢æˆå¼ºç±»å‹çš„ Java,
å¯èƒ½å®ç°å°±æ²¡è¿™ä¹ˆç®€å•äº†.
</p>

</blockquote></div>

<p>
çœ‹æ¥å·²ç»ä¼˜åŠ¿å·²ç»é€æ­¥æ˜æ˜¾äº†å‘¢, Monad é‡Œé¢ä¿ç•™äº†å€¼çš„ context,
ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯¹è¿™ä¸ª Monad å¯ä»¥é›†ä¸­åœ¨å•ç‹¬çš„æœ¬æ¬¡å¦‚ä½•æ“ä½œvalue, è€Œä¸ç”¨å…³å¿ƒ
context.
</p>

<div class="epigraph"><blockquote>
<p>
è¿˜æœ‰ä¸€ä¸ª Monad å«åš Maybe, å®é™…ä¸Šçš®å°”æ–¯çš„ğŸŒ°ç”¨ Maybe æ›´ä¸ºåˆé€‚, å› ä¸º
Maybe æœ‰ä¸¤ç§çŠ¶æ€, ä¸€ç§æ˜¯æœ‰å€¼ Just, ä¸€ç§æ˜¯æ²¡ä¸œè¥¿ Nothing,
å¯ä»¥è‡ªå·±å®ç°è¯•è¯•.
</p>

</blockquote></div>
</div>
</div>

<div id="outline-container-org276320c" class="outline-3">
<h3 id="org276320c"><span class="section-number-3">6.4</span> Monad åœ¨ JavaScript ä¸­çš„åº”ç”¨</h3>
<div class="outline-text-3" id="text-6-4">
<p>
ä½ çŸ¥é“ ES6æœ‰ä¸ªæ–°çš„ ç±»å‹
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise#Browser_compatibility">Promise</a>
å—, å¦‚æœä¸çŸ¥é“, æƒ³å¿…ä¹Ÿå¬è¿‡ jQuery çš„ <code>$.ajax</code> å§, ä½†å¦‚æœä½ æ²¡å¬è¿‡ promise,
è¯´æ˜ä½ æ²¡æœ‰è®¤çœŸçœ‹è¿‡ä»–çš„è¿”å›å€¼:
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">aPromise</span> = $.ajax({
    url: <span style="color: #8b0000;">"https://api.github.com/users/jcouyang/gists"</span>
    dataType: <span style="color: #8b0000;">'jsonp'</span>
    })
aPromise <span style="color: #8b0000;">/***</span>
<span style="color: #8b0000;">=&gt; Object { state: .Deferred/r.state(),</span>
<span style="color: #8b0000;">    always: .Deferred/r.always(),</span>
<span style="color: #8b0000;">    then: .Deferred/r.then(),</span>
<span style="color: #8b0000;">    promise: .Deferred/r.promise(),</span>
<span style="color: #8b0000;">    pipe: .Deferred/r.then(),</span>
<span style="color: #8b0000;">    done: b.Callbacks/p.add(),</span>
<span style="color: #8b0000;">    fail: b.Callbacks/p.add(),</span>
<span style="color: #8b0000;">    progress: b.Callbacks/p.add() }</span>
<span style="color: #8b0000;">***/</span>
</pre>
</div>

<p>
æˆ‘ä»¬çœ‹åˆ°è¿”å›äº†å¥½å¤š <code>Deferred</code> ç±»å‹çš„ç©æ„, æˆ‘ä»¬æ¥è¯•è¯•è¿™ç©æ„æœ‰ä»€ä¹ˆç”¨
</p>

<div class="org-src-container">
<pre class="src src-js">anotherPromise = aPromise.then(_ =&gt; _.data.forEach(y=&gt; console.log(y.description)))
<span style="color: #8c8c8c; font-style: italic;">/* </span><span style="color: #8c8c8c; font-style: italic;">=&gt;</span>
<span style="color: #8c8c8c; font-style: italic;">Object { state: .Deferred/r.state(),</span>
<span style="color: #8c8c8c; font-style: italic;">    always: .Deferred/r.always(),</span>
<span style="color: #8c8c8c; font-style: italic;">    then: .Deferred/r.then(),</span>
<span style="color: #8c8c8c; font-style: italic;">    promise: .Deferred/r.promise(),</span>
<span style="color: #8c8c8c; font-style: italic;">    pipe: .Deferred/r.then(),</span>
<span style="color: #8c8c8c; font-style: italic;">    done: b.Callbacks/p.add(),</span>
<span style="color: #8c8c8c; font-style: italic;">    fail: b.Callbacks/p.add(),</span>
<span style="color: #8c8c8c; font-style: italic;">    progress: b.Callbacks/p.add() }</span>

<span style="color: #8c8c8c; font-style: italic;">"connect cisco anyconnect in terminal"</span>
<span style="color: #8c8c8c; font-style: italic;">"&#20026;&#20160;&#20040;&#35201;&#26607;&#37324;&#21270;&#65288;curry&#65289;"</span>
<span style="color: #8c8c8c; font-style: italic;">"&#25209;&#37327;&#33719;&#21462;&#20154;&#20154;&#24433;&#35270;&#19979;&#36733;&#38142;&#25509;"</span>
<span style="color: #8c8c8c; font-style: italic;">......</span>
<span style="color: #8c8c8c; font-style: italic;">*/</span>
</pre>
</div>

<p>
çœ‹è§æ²¡æœ‰, ä»–åˆè¿”å›äº†åŒæ ·ä¸€ä¸ªä¸œè¥¿, è€Œä¸”ä¼ ç»™ then
çš„å‡½æ•°å¯ä»¥æ“ä½œè¿™ä¸ªå¯¹è±¡é‡Œé¢çš„å€¼. è¿™ä¸ªå¯¹è±¡å…¶å®å°±æ˜¯ Promise äº†.
ä¸ºä»€ä¹ˆè¯´è¿™æ˜¯ Monad å‘¢, æ¥è¯•è¯•å†å†™ä¸€æ¬¡ <code>èµ°é’¢ä¸</code>:
</p>

<div class="epigraph"><blockquote>
<p>
è¿™é‡Œæˆ‘ä»¬ç”¨çš„æ˜¯ ES6 çš„ Promise, è€Œä¸ç”¨ jQuery Defered, è®°å¾—ç”¨ firefox
å“¦. å¦å¤– eweda å¯ä»¥è¿™æ ·è£…
</p>

</blockquote></div>

<pre class="example">
var ewd = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            ewd.src = 'https://rawgit.com/CrossEye/eweda/master/eweda.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ewd);
eweda.installTo(this);
</pre>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #00008b;">var</span> <span style="color: #b8860b;">land</span> = eweda.curry(<span style="color: #00008b;">function</span>(<span style="color: #b8860b;">lr</span>, <span style="color: #b8860b;">n</span>, <span style="color: #b8860b;">pole</span>){
    pole[lr] = pole[lr] + n;
    <span style="color: #00008b;">if</span>(Math.abs(pole[0]-pole[1]) &gt; 3) {
      <span style="color: #00008b;">return</span> <span style="color: #00008b;">new</span> <span style="color: #36648b;">Promise</span>((resovle,reject)=&gt;reject(<span style="color: #8b0000;">"dead when land "</span> + n + <span style="color: #8b0000;">" became "</span> + pole));
    }
    <span style="color: #00008b;">return</span> <span style="color: #00008b;">new</span> <span style="color: #36648b;">Promise</span>((resolve,reject)=&gt;resolve(pole));
});

<span style="color: #00008b;">var</span> <span style="color: #b8860b;">landLeft</span> = land(0)
<span style="color: #00008b;">var</span> <span style="color: #b8860b;">landRight</span> = land(1);

Promise.all([0,0])
.then(landLeft(2), _=&gt;_)
.then(landRight(3), _=&gt;_) <span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; Array [ 2, 3 ]</span>
.then(landLeft(10), _=&gt;_)
.then(landRight(10), _=&gt;_)
.then(_=&gt;console.log(_),_=&gt;console.log(_))
<span style="color: #8c8c8c; font-style: italic;">// </span><span style="color: #8c8c8c; font-style: italic;">=&gt; "dead when land 10 became 12,3"</span>
</pre>
</div>

<p>
è¿™ä¸‹æ˜¯ä¸æ‰¿è®¤ Promise å°±æ˜¯ Monad äº†. åŸæ¥æˆ‘ä»¬æ—©å·²åœ¨ä½¿ç”¨è¿™ä¸ªç¥ç§˜çš„ Monad,
å†æƒ³æƒ³ Promise,ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæŠ½è±¡å’Œç¥ç§˜äº†.
</p>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
FogusåŒæ—¶æ˜¯The Joy of Clojureçš„ä½œè€…,æˆ‘
ç‰¹åˆ«å¥‡æ€ªä¸ºä»€ä¹ˆä¸æŠŠClojureçœŸæ­£Good partå†™è¿›Functional JavaScripté‡Œ
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2">2</a></sup> <div class="footpara"><p class="footpara">
ç¬¬äºŒç« ä¼šè¯¦ç»†è§£é‡Šé«˜é˜¶å‡½æ•°å’Œé—­åŒ….
</p></div></div>

<div class="footdef"><sup><a id="fn.3" class="footnum" href="#fnr.3">3</a></sup> <div class="footpara"><p class="footpara">
æŸ¯é‡ŒåŒ–ä¼šåœ¨ç¬¬äºŒç« è¯¦ç»†è®¨è®º.
</p></div></div>

<div class="footdef"><sup><a id="fn.4" class="footnum" href="#fnr.4">4</a></sup> <div class="footpara"><p class="footpara">
å¯ä»¥çœ‹çœ‹es6æ¯”è¾ƒæœ‰æ„æ€çš„æ–°ç‰¹æ€§ <a href="https://blog.oyanglul.us/javascript/essential-ecmascript6.html">https://blog.oyanglul.us/javascript/essential-ecmascript6.html</a>
</p></div></div>

<div class="footdef"><sup><a id="fn.5" class="footnum" href="#fnr.5">5</a></sup> <div class="footpara"><p class="footpara">
Chromeæœ‰ä¸€ä¸ª feature toggle å¯ä»¥æ‰“å¼€éƒ¨åˆ† es6 åŠŸèƒ½ <code>chrome://flags/#enable-javascript-harmony</code>
</p></div></div>

<div class="footdef"><sup><a id="fn.6" class="footnum" href="#fnr.6">6</a></sup> <div class="footpara"><p class="footpara">
Clojureçš„ä½œè€…
</p></div></div>

<div class="footdef"><sup><a id="fn.7" class="footnum" href="#fnr.7">7</a></sup> <div class="footpara"><p class="footpara">
æˆ‘æ˜¯æ•…æ„å§reduceçš„å‚æ•°é¡ºåºå†™"å"çš„, åŸæ¥underscoreæ˜¯å…ˆæ¶ˆè´¹collectionçš„. è‡³äºä¸ºä»€ä¹ˆè¦åè¿‡æ¥
å¯ä»¥å‚è€ƒ<a href="https://blog.oyanglul.us/javascript/functional-javascript.html#sec-3-2">è¿™ä¸ªè§£é‡Š</a>
</p></div></div>

<div class="footdef"><sup><a id="fn.8" class="footnum" href="#fnr.8">8</a></sup> <div class="footpara"><p class="footpara">
clojurescriptä½œè€…æŠŠclojurescriptçš„ä¸€äº›æ•°æ®ç»“æ„å’Œå‡½æ•°ç¼–è¯‘æˆjavascript, è¿™æ ·å°±å¯ä»¥ç”¨æ™®é€šjsä½¿ç”¨
clojureä¸­çš„æ•°æ®ç»“æ„å’Œå‡½æ•°. documentä¸¥é‡è¿‡æ—¶, å»ºè®®çœ‹å¯¼å…¥çš„<a href="https://github.com/swannodette/mori/blob/master/src/mori.cljs">æºä»£ç </a>, ä»¥åŠclojureçš„æ–‡æ¡£, æ¥å£å’ŒclojureåŸºæœ¬ä¸€è‡´.
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<footer>
  <p>Author: Jichao Ouyang
    <a class="github-button" href="https://github.com/sponsors/jcouyang" data-icon="octicon-heart" aria-label="Sponsor @jcouyang on GitHub">Sponsor</a>
    <a aria-label="Follow @jcouyang on GitHub" data-count-aria-label="# followers on GitHub" data-count-api="/users/jcouyang#followers" data-count-href="/jcouyang/followers" href="https://github.com/jcouyang" class="github-button">Follow</a>
  </p>
  <p>Created: 2015-05-13 Wed 00:00</p>
  <p>Generated by: <a href="https://www.gnu.org/software/emacs/">Emacs</a> 26.3 (<a href="https://orgmode.org">Org</a> mode 9.3.6) &#215; <a href="https://github.com/jcouyang/orgpress">OrgPress</a></p>
  <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License</a>.
  <input type="swiftype" class="st-default-search-input" placeholder="Search"/>
  <a class="gumroad-button" href="https://gum.co/grokking-monad?wanted=true" target="_blank" data-gumroad-single-product="true">èŒƒç•´è®ºè£…é€¼æŒ‡å—ï¼Œè¯·è‡ªè§‰æ’é˜Ÿè£…é€¼</a>
  <div id="danmaku-comments"></div>
  <div id="disqus_thread"></div>
</footer>
</div>
</body>
</html>
